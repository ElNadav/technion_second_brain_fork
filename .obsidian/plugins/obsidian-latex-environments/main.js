/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
__export(exports, {
  default: () => LatexEnvironments
});
var import_obsidian3 = __toModule(require("obsidian"));

// src/settings.ts
var LatexEnvironmentsSettings = class {
  constructor() {
    this.defaultEnvironment = "multline";
    this.customEnvironments = [];
  }
};
function ensureSettings(loaded) {
  var _a, _b;
  const settings = new LatexEnvironmentsSettings();
  settings.defaultEnvironment = (_a = loaded.defaultEnvironment) != null ? _a : settings.defaultEnvironment;
  settings.customEnvironments = (_b = loaded.customEnvironments) != null ? _b : settings.customEnvironments;
  return settings;
}

// src/envmodal.ts
var import_obsidian = __toModule(require("obsidian"));

// src/environmentNames.ts
var DISPLAY_EQUATIONS = [
  "equation",
  "equation*",
  "gather",
  "gather*",
  "multline",
  "multline*",
  "split",
  "align",
  "align*",
  "flalign",
  "flalign*",
  "alignat",
  "alignat*"
];
var MATRICES = [
  "matrix",
  "pmatrix",
  "bmatrix",
  "Bmatrix",
  "vmatrix",
  "Vmatrix",
  "smallmatrix"
];
var SUB_ENVIRONMENTS = ["multlined", "gathered", "aligned", "cases"];
var DEFAULT_ENVIRONMENTS = [
  ...DISPLAY_EQUATIONS,
  ...MATRICES,
  ...SUB_ENVIRONMENTS
];

// src/envmodal.ts
var EnvModal = class extends import_obsidian.FuzzySuggestModal {
  constructor(app, settings, name, callback) {
    super(app);
    this.settings = settings;
    this.name = name;
    this.callback = callback;
    this.matched = false;
    this.setInstructions([
      { command: "\u2191\u2193", purpose: "to navigate" },
      { command: "\u21B5", purpose: "to select" },
      { command: "esc", purpose: "to dismiss" }
    ]);
    this.setPlaceholder("environment name");
  }
  getItems() {
    return Array.from(new Set([this.settings.defaultEnvironment].concat(this.settings.customEnvironments, DEFAULT_ENVIRONMENTS)));
  }
  getItemText(item) {
    this.matched = true;
    return item;
  }
  onNoSuggestion() {
    this.matched = false;
  }
  onChooseItem(item, _evt) {
    if (this.matched) {
      this.callback(item);
    } else {
      this.callback(this.inputEl.value);
    }
  }
  static callback(app, settings, defaultName, call) {
    new EnvModal(app, settings, defaultName, call).open();
  }
};

// src/latexEnvironmentsSettingsTab.ts
var import_obsidian2 = __toModule(require("obsidian"));
var LatexEnvironmentsSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Settings for latex environments" });
    new import_obsidian2.Setting(containerEl).setName("Default environment").setDesc("The default environment to insert").addText((text) => text.setPlaceholder("environment").setValue(this.plugin.settings.defaultEnvironment).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.defaultEnvironment = value;
      yield this.plugin.saveData(this.plugin.settings);
    })));
    new import_obsidian2.Setting(containerEl).setName("Extra environments").setDesc("Environment names to be suggested for completion (one per line)").addTextArea((area) => {
      area.setValue(this.plugin.settings.customEnvironments.join("\n")).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.customEnvironments = value.split("\n").map((x) => x.trim()).filter((x) => x.length > 0);
        yield this.plugin.saveData(this.plugin.settings);
      }));
    });
  }
};

// src/actions/action.ts
var Action = class {
  constructor(doc) {
    this.doc = doc;
  }
  suggestName() {
    return void 0;
  }
  get needsName() {
    return true;
  }
};

// src/environment.ts
function newEnvironment(name, cursor, contents = "") {
  return {
    replaceSelection: `\\begin{${name}}${padContents(contents, true)}\\end{${name}}`,
    selection: {
      from: {
        ch: 0,
        line: cursor.line + 1
      }
    }
  };
}
function wrapSelection(name, cursor, contents = "") {
  return {
    replaceSelection: `\\begin{${name}}${padContents(contents)}\\end{${name}}`,
    selection: {
      from: {
        ch: 0,
        line: cursor.line + 1
      }
    }
  };
}
function wrapBlock(name, doc, block) {
  const blockText = block.text.slice(block.startPosition, block.endPosition);
  let cursor = doc.getCursor();
  const start = doc.offsetToPos(block.startPosition);
  if (cursor.line === start.line) {
    cursor = {
      line: cursor.line + 1,
      ch: blockText.length
    };
  }
  return {
    changes: [
      {
        from: doc.offsetToPos(block.startPosition),
        to: doc.offsetToPos(block.endPosition),
        text: `\\begin{${name}}${padContents(blockText)}\\end{${name}}`
      }
    ],
    selection: { from: cursor }
  };
}
function unwrapEnvironment(environment, doc) {
  let cursor = doc.getCursor();
  if (justWhitespace(environment.contents.split("\n", 1)[0])) {
    cursor = {
      line: cursor.line - 1,
      ch: cursor.ch + doc.offsetToPos(environment.begin.from).ch
    };
  }
  return {
    changes: [
      {
        text: trim(environment.contents),
        from: doc.offsetToPos(environment.begin.from),
        to: doc.offsetToPos(environment.end.to)
      }
    ],
    selection: { from: cursor }
  };
}
function changeEnvironment(environment, doc, name) {
  const change = {
    text: `\\begin{${name}}${environment.contents}\\end{${name}}`,
    from: doc.offsetToPos(environment.begin.from),
    to: doc.offsetToPos(environment.end.to)
  };
  return {
    changes: [change],
    selection: { from: doc.getCursor() }
  };
}
function padContents(contents, padEmpty = false) {
  const lines = contents.split("\n");
  return `${getPad(lines[0], padEmpty)}${contents}${getPad(lines[lines.length - 1], padEmpty)}`;
}
function justWhitespace(text) {
  return text.match(/^[ \t]*$/) != null;
}
function getPad(text, padEmpty = false) {
  if (text.length === 0 && padEmpty)
    return "\n";
  if (text.length === 0 || justWhitespace(text))
    return "";
  return "\n";
}
function trim(text) {
  if (text.length === 0)
    return text;
  const start = text.startsWith("\n") ? 1 : 0;
  const end = text.endsWith("\n") ? text.length - 1 : text.length;
  return text.slice(start, end);
}

// src/search.ts
var SearchCursor = class {
  constructor(text, regex, _originalCaret) {
    this.text = text;
    this._originalCaret = _originalCaret;
    if (regex instanceof RegExp) {
      this.regex = regex;
    } else {
      this.regex = new RegExp(regex);
    }
    this.reset();
  }
  reset() {
    this._from = this._originalCaret;
    this._to = this._originalCaret;
    this._caret = this._originalCaret;
  }
  findNext() {
    const text = this.text.slice(this._caret);
    const match = text.match(this.regex);
    if ((match == null ? void 0 : match.index) == null) {
      return void 0;
    }
    this._from = this._caret + match.index;
    this._to = this._caret + match.index + match[0].length;
    this._caret = this._to;
    return match;
  }
  findPrevious() {
    const reverseRegex = new RegExp(`(?<full>${this.regex.source})(?![\\s\\S]*\\k<full>)`, this.regex.flags);
    const text = this.text.slice(0, this._caret);
    const lastMatch = text.match(reverseRegex);
    if ((lastMatch == null ? void 0 : lastMatch.index) == null || (lastMatch == null ? void 0 : lastMatch.groups) == null) {
      return void 0;
    }
    this._from = lastMatch.index;
    this._to = lastMatch.index + lastMatch.groups.full.length;
    this._caret = this._from;
    return lastMatch;
  }
  to() {
    return this._to;
  }
  from() {
    return this._from;
  }
};

// src/mathblock.ts
var MathBlock = class {
  constructor(text, cursor) {
    this.text = text;
    const searchCursor = new SearchCursor(text, "\\$\\$", cursor);
    this.startPosition = searchCursor.findPrevious() != null ? searchCursor.to() : 0;
    searchCursor.reset();
    this.endPosition = searchCursor.findNext() != null ? searchCursor.from() : text.length;
  }
  getEnclosingEnvironment(cursor) {
    const beginEnds = new BeginEnds(this.text, this.startPosition, this.endPosition);
    const environments = Array.from(beginEnds);
    if (beginEnds.isOpen) {
      throw new Error("unclosed environments in block");
    }
    const start = environments.filter((env) => env.type === "begin" && env.from < cursor).pop();
    if (start === void 0) {
      return void 0;
    }
    const after = environments.filter((env) => env.from > start.to);
    let open = 1;
    let end;
    for (const env of after) {
      if (env.type === "begin") {
        open++;
      } else {
        open--;
        if (open === 0) {
          end = env;
          break;
        }
      }
    }
    if (end === void 0) {
      throw new Error("current environment is never closed");
    }
    if (end.to < cursor) {
      return void 0;
    }
    return {
      name: start.name,
      begin: start,
      end,
      contents: this.text.slice(start.to, end.from)
    };
  }
  static isMathMode(_cursor, _editor) {
    return true;
  }
};
var BeginEnds = class {
  constructor(text, start, end) {
    this.text = text;
    this.start = start;
    this.end = end;
    this.openEnvs = [];
    this.search = this.getEnvCursor(this.start);
  }
  reset() {
    this.search = this.getEnvCursor(this.start);
  }
  getEnvCursor(start) {
    return new SearchCursor(this.text, /\\(?<beginEnd>begin|end){\s*(?<name>[^}]+)\s*}/m, start);
  }
  get isOpen() {
    return this.openEnvs.length > 0;
  }
  [Symbol.iterator]() {
    this.reset();
    return this;
  }
  next() {
    const match = this.search.findNext();
    const to = this.search.to();
    if ((match == null ? void 0 : match.groups) == null || to > this.end) {
      return { done: true, value: null };
    }
    switch (match.groups.beginEnd) {
      case "begin": {
        const current = {
          name: match.groups.name,
          type: "begin",
          from: this.search.from(),
          to: this.search.to()
        };
        this.openEnvs.push(current);
        return {
          done: false,
          value: current
        };
      }
      case "end": {
        const current = this.openEnvs.pop();
        if (current === void 0) {
          throw new Error("closing environment which was never opened");
        }
        if (current.name !== match.groups.name) {
          throw new Error("environment not closed properly");
        }
        return {
          done: false,
          value: {
            name: match.groups.name,
            type: "end",
            from: this.search.from(),
            to: this.search.to()
          }
        };
      }
    }
    throw new Error(`regex returned unexpected result ${match[1]}`);
  }
};

// src/actions/wrapAction.ts
var WrapAction = class extends Action {
  prepare() {
    return this;
  }
  transaction(envName) {
    if (this.doc.somethingSelected()) {
      return wrapSelection(envName, this.doc.getCursor(), this.doc.getSelection());
    }
    const block = new MathBlock(this.doc.getValue(), this.doc.posToOffset(this.doc.getCursor()));
    return wrapBlock(envName, this.doc, block);
  }
};

// src/actions/insertAction.ts
var InsertAction = class extends Action {
  prepare() {
    if (this.doc.somethingSelected()) {
      return new WrapAction(this.doc).prepare();
    }
    return this;
  }
  transaction(envName) {
    return newEnvironment(envName, this.doc.getCursor());
  }
};

// src/actions/changeAction.ts
var ChangeAction = class extends Action {
  suggestName() {
    return this.name;
  }
  prepare() {
    const cursor = this.doc.posToOffset(this.doc.getCursor());
    const block = new MathBlock(this.doc.getValue(), cursor);
    this.current = block.getEnclosingEnvironment(cursor);
    if (this.current === void 0 || this.doc.somethingSelected()) {
      return new WrapAction(this.doc);
    }
    this.name = this.current.name;
    return this;
  }
  transaction(envName) {
    if (this.current !== void 0) {
      return changeEnvironment(this.current, this.doc, envName);
    }
    return {};
  }
};

// src/actions/deleteAction.ts
var DeleteAction = class extends Action {
  get needsName() {
    return false;
  }
  prepare() {
    const cursor = this.doc.getCursor();
    const block = new MathBlock(this.doc.getValue(), this.doc.posToOffset(cursor));
    this.current = block.getEnclosingEnvironment(this.doc.posToOffset(cursor));
    return this;
  }
  transaction(_envName) {
    if (this.current !== void 0) {
      return unwrapEnvironment(this.current, this.doc);
    }
    return {};
  }
};

// src/main.ts
var LatexEnvironments = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.settings = new LatexEnvironmentsSettings();
  }
  onload() {
    return __async(this, null, function* () {
      const settings = yield this.loadData();
      if (settings !== null) {
        this.settings = ensureSettings(settings);
      }
      this.addCommand({
        id: "insert-latex-env",
        name: "Insert LaTeX environment",
        editorCallback: this.mathModeCallback(InsertAction)
      });
      this.addCommand({
        id: "change-latex-env",
        name: "Change LaTeX environment",
        editorCallback: this.mathModeCallback(ChangeAction)
      });
      this.addCommand({
        id: "delete-latex-env",
        name: "Delete LaTeX environment",
        editorCallback: this.mathModeCallback(DeleteAction)
      });
      this.addSettingTab(new LatexEnvironmentsSettingTab(this.app, this));
    });
  }
  mathModeCallback(ActionType) {
    return (editor, _view) => {
      try {
        const action = new ActionType(editor).prepare();
        this.withPromptName(editor, action);
      } catch (e) {
        new import_obsidian3.Notice(e.message);
      }
    };
  }
  withPromptName(editor, action) {
    const call = (envName) => {
      editor.transaction(action.transaction(envName));
      editor.focus();
    };
    if (action.needsName) {
      const suggested = action.suggestName();
      EnvModal.callback(this.app, this.settings, suggested !== void 0 ? suggested : this.settings.defaultEnvironment, call);
    } else {
      call("*");
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vLi4vZGV2L29ic2lkaWFuX3BsdWdpbnNfZGV2L29ic2lkaWFuLWxhdGV4LWVudmlyb25tZW50cy9zcmMvbWFpbi50cyIsICIuLi8uLi8uLi8uLi8uLi9kZXYvb2JzaWRpYW5fcGx1Z2luc19kZXYvb2JzaWRpYW4tbGF0ZXgtZW52aXJvbm1lbnRzL3NyYy9zZXR0aW5ncy50cyIsICIuLi8uLi8uLi8uLi8uLi9kZXYvb2JzaWRpYW5fcGx1Z2luc19kZXYvb2JzaWRpYW4tbGF0ZXgtZW52aXJvbm1lbnRzL3NyYy9lbnZtb2RhbC50cyIsICIuLi8uLi8uLi8uLi8uLi9kZXYvb2JzaWRpYW5fcGx1Z2luc19kZXYvb2JzaWRpYW4tbGF0ZXgtZW52aXJvbm1lbnRzL3NyYy9lbnZpcm9ubWVudE5hbWVzLnRzIiwgIi4uLy4uLy4uLy4uLy4uL2Rldi9vYnNpZGlhbl9wbHVnaW5zX2Rldi9vYnNpZGlhbi1sYXRleC1lbnZpcm9ubWVudHMvc3JjL2xhdGV4RW52aXJvbm1lbnRzU2V0dGluZ3NUYWIudHMiLCAiLi4vLi4vLi4vLi4vLi4vZGV2L29ic2lkaWFuX3BsdWdpbnNfZGV2L29ic2lkaWFuLWxhdGV4LWVudmlyb25tZW50cy9zcmMvYWN0aW9ucy9hY3Rpb24udHMiLCAiLi4vLi4vLi4vLi4vLi4vZGV2L29ic2lkaWFuX3BsdWdpbnNfZGV2L29ic2lkaWFuLWxhdGV4LWVudmlyb25tZW50cy9zcmMvZW52aXJvbm1lbnQudHMiLCAiLi4vLi4vLi4vLi4vLi4vZGV2L29ic2lkaWFuX3BsdWdpbnNfZGV2L29ic2lkaWFuLWxhdGV4LWVudmlyb25tZW50cy9zcmMvc2VhcmNoLnRzIiwgIi4uLy4uLy4uLy4uLy4uL2Rldi9vYnNpZGlhbl9wbHVnaW5zX2Rldi9vYnNpZGlhbi1sYXRleC1lbnZpcm9ubWVudHMvc3JjL21hdGhibG9jay50cyIsICIuLi8uLi8uLi8uLi8uLi9kZXYvb2JzaWRpYW5fcGx1Z2luc19kZXYvb2JzaWRpYW4tbGF0ZXgtZW52aXJvbm1lbnRzL3NyYy9hY3Rpb25zL3dyYXBBY3Rpb24udHMiLCAiLi4vLi4vLi4vLi4vLi4vZGV2L29ic2lkaWFuX3BsdWdpbnNfZGV2L29ic2lkaWFuLWxhdGV4LWVudmlyb25tZW50cy9zcmMvYWN0aW9ucy9pbnNlcnRBY3Rpb24udHMiLCAiLi4vLi4vLi4vLi4vLi4vZGV2L29ic2lkaWFuX3BsdWdpbnNfZGV2L29ic2lkaWFuLWxhdGV4LWVudmlyb25tZW50cy9zcmMvYWN0aW9ucy9jaGFuZ2VBY3Rpb24udHMiLCAiLi4vLi4vLi4vLi4vLi4vZGV2L29ic2lkaWFuX3BsdWdpbnNfZGV2L29ic2lkaWFuLWxhdGV4LWVudmlyb25tZW50cy9zcmMvYWN0aW9ucy9kZWxldGVBY3Rpb24udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4sIEVkaXRvciB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgZW5zdXJlU2V0dGluZ3MsIExhdGV4RW52aXJvbm1lbnRzU2V0dGluZ3MgfSBmcm9tICcuL3NldHRpbmdzJztcclxuaW1wb3J0IHsgRW52TW9kYWwgfSBmcm9tICcuL2Vudm1vZGFsJztcclxuaW1wb3J0IHsgTGF0ZXhFbnZpcm9ubWVudHNTZXR0aW5nVGFiIH0gZnJvbSAnLi9sYXRleEVudmlyb25tZW50c1NldHRpbmdzVGFiJztcclxuaW1wb3J0IHsgSW5zZXJ0QWN0aW9uIH0gZnJvbSAnLi9hY3Rpb25zL2luc2VydEFjdGlvbic7XHJcbmltcG9ydCB7IENoYW5nZUFjdGlvbiB9IGZyb20gJy4vYWN0aW9ucy9jaGFuZ2VBY3Rpb24nO1xyXG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tICcuL2FjdGlvbnMvYWN0aW9uJztcclxuaW1wb3J0IHsgRGVsZXRlQWN0aW9uIH0gZnJvbSAnLi9hY3Rpb25zL2RlbGV0ZUFjdGlvbic7XHJcbmltcG9ydCB7IEVkaXRvckxpa2UgfSBmcm9tICcuL2VkaXRvckxpa2UnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGF0ZXhFbnZpcm9ubWVudHMgZXh0ZW5kcyBQbHVnaW4ge1xyXG4gIHB1YmxpYyBzZXR0aW5nczogTGF0ZXhFbnZpcm9ubWVudHNTZXR0aW5ncyA9IG5ldyBMYXRleEVudmlyb25tZW50c1NldHRpbmdzKCk7XHJcblxyXG4gIGFzeW5jIG9ubG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xyXG4gICAgaWYgKHNldHRpbmdzICE9PSBudWxsKSB7XHJcbiAgICAgIHRoaXMuc2V0dGluZ3MgPSBlbnN1cmVTZXR0aW5ncyhzZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICdpbnNlcnQtbGF0ZXgtZW52JyxcclxuICAgICAgbmFtZTogJ0luc2VydCBMYVRlWCBlbnZpcm9ubWVudCcsXHJcbiAgICAgIGVkaXRvckNhbGxiYWNrOiB0aGlzLm1hdGhNb2RlQ2FsbGJhY2soSW5zZXJ0QWN0aW9uKSxcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiAnY2hhbmdlLWxhdGV4LWVudicsXHJcbiAgICAgIG5hbWU6ICdDaGFuZ2UgTGFUZVggZW52aXJvbm1lbnQnLFxyXG4gICAgICBlZGl0b3JDYWxsYmFjazogdGhpcy5tYXRoTW9kZUNhbGxiYWNrKENoYW5nZUFjdGlvbiksXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ2RlbGV0ZS1sYXRleC1lbnYnLFxyXG4gICAgICBuYW1lOiAnRGVsZXRlIExhVGVYIGVudmlyb25tZW50JyxcclxuICAgICAgZWRpdG9yQ2FsbGJhY2s6IHRoaXMubWF0aE1vZGVDYWxsYmFjayhEZWxldGVBY3Rpb24pLFxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBMYXRleEVudmlyb25tZW50c1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgbWF0aE1vZGVDYWxsYmFjazxBIGV4dGVuZHMgQWN0aW9uPihcclxuICAgIEFjdGlvblR5cGU6IG5ldyAoZG9jOiBFZGl0b3JMaWtlKSA9PiBBLFxyXG4gICkge1xyXG4gICAgcmV0dXJuIChlZGl0b3I6IEVkaXRvciwgX3ZpZXc6IE1hcmtkb3duVmlldykgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IG5ldyBBY3Rpb25UeXBlKGVkaXRvcikucHJlcGFyZSgpO1xyXG4gICAgICAgIHRoaXMud2l0aFByb21wdE5hbWUoZWRpdG9yLCBhY3Rpb24pO1xyXG4gICAgICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmV3ICovXHJcbiAgICAgICAgbmV3IE5vdGljZShlLm1lc3NhZ2UpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB3aXRoUHJvbXB0TmFtZShlZGl0b3I6IEVkaXRvckxpa2UsIGFjdGlvbjogQWN0aW9uKTogdm9pZCB7XHJcbiAgICBjb25zdCBjYWxsID0gKGVudk5hbWU6IHN0cmluZyk6IHZvaWQgPT4ge1xyXG4gICAgICBlZGl0b3IudHJhbnNhY3Rpb24oYWN0aW9uLnRyYW5zYWN0aW9uKGVudk5hbWUpKTtcclxuICAgICAgZWRpdG9yLmZvY3VzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChhY3Rpb24ubmVlZHNOYW1lKSB7XHJcbiAgICAgIGNvbnN0IHN1Z2dlc3RlZCA9IGFjdGlvbi5zdWdnZXN0TmFtZSgpO1xyXG4gICAgICBFbnZNb2RhbC5jYWxsYmFjayhcclxuICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICB0aGlzLnNldHRpbmdzLFxyXG4gICAgICAgIHN1Z2dlc3RlZCAhPT0gdW5kZWZpbmVkID8gc3VnZ2VzdGVkIDogdGhpcy5zZXR0aW5ncy5kZWZhdWx0RW52aXJvbm1lbnQsXHJcbiAgICAgICAgY2FsbCxcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhbGwoJyonKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwgImV4cG9ydCBjbGFzcyBMYXRleEVudmlyb25tZW50c1NldHRpbmdzIHtcclxuICBwdWJsaWMgZGVmYXVsdEVudmlyb25tZW50ID0gJ211bHRsaW5lJztcclxuICBwdWJsaWMgY3VzdG9tRW52aXJvbm1lbnRzOiBzdHJpbmdbXSA9IFtdO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBMb2FkZWRTZXR0aW5ncyA9IFBhcnRpYWw8TGF0ZXhFbnZpcm9ubWVudHNTZXR0aW5ncz47XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZW5zdXJlU2V0dGluZ3MoXHJcbiAgbG9hZGVkOiBMb2FkZWRTZXR0aW5ncyxcclxuKTogTGF0ZXhFbnZpcm9ubWVudHNTZXR0aW5ncyB7XHJcbiAgY29uc3Qgc2V0dGluZ3MgPSBuZXcgTGF0ZXhFbnZpcm9ubWVudHNTZXR0aW5ncygpO1xyXG5cclxuICBzZXR0aW5ncy5kZWZhdWx0RW52aXJvbm1lbnQgPVxyXG4gICAgbG9hZGVkLmRlZmF1bHRFbnZpcm9ubWVudCA/PyBzZXR0aW5ncy5kZWZhdWx0RW52aXJvbm1lbnQ7XHJcblxyXG4gIHNldHRpbmdzLmN1c3RvbUVudmlyb25tZW50cyA9XHJcbiAgICBsb2FkZWQuY3VzdG9tRW52aXJvbm1lbnRzID8/IHNldHRpbmdzLmN1c3RvbUVudmlyb25tZW50cztcclxuXHJcbiAgcmV0dXJuIHNldHRpbmdzO1xyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBMYXRleEVudmlyb25tZW50c1NldHRpbmdzIH0gZnJvbSAnLi9zZXR0aW5ncyc7XHJcbmltcG9ydCB7IERFRkFVTFRfRU5WSVJPTk1FTlRTIH0gZnJvbSAnLi9lbnZpcm9ubWVudE5hbWVzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBFbnZNb2RhbCBleHRlbmRzIEZ1enp5U3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xyXG4gIHByaXZhdGUgbWF0Y2hlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgYXBwOiBBcHAsXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNldHRpbmdzOiBMYXRleEVudmlyb25tZW50c1NldHRpbmdzLFxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBuYW1lOiBzdHJpbmcsXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGNhbGxiYWNrOiAobmFtZTogc3RyaW5nKSA9PiB2b2lkLFxyXG4gICkge1xyXG4gICAgc3VwZXIoYXBwKTtcclxuICAgIHRoaXMuc2V0SW5zdHJ1Y3Rpb25zKFtcclxuICAgICAgeyBjb21tYW5kOiAnXHUyMTkxXHUyMTkzJywgcHVycG9zZTogJ3RvIG5hdmlnYXRlJyB9LFxyXG4gICAgICB7IGNvbW1hbmQ6ICdcdTIxQjUnLCBwdXJwb3NlOiAndG8gc2VsZWN0JyB9LFxyXG4gICAgICB7IGNvbW1hbmQ6ICdlc2MnLCBwdXJwb3NlOiAndG8gZGlzbWlzcycgfSxcclxuICAgIF0pO1xyXG4gICAgdGhpcy5zZXRQbGFjZWhvbGRlcignZW52aXJvbm1lbnQgbmFtZScpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldEl0ZW1zKCk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKFxyXG4gICAgICBuZXcgU2V0KFxyXG4gICAgICAgIFt0aGlzLnNldHRpbmdzLmRlZmF1bHRFbnZpcm9ubWVudF0uY29uY2F0KFxyXG4gICAgICAgICAgdGhpcy5zZXR0aW5ncy5jdXN0b21FbnZpcm9ubWVudHMsXHJcbiAgICAgICAgICBERUZBVUxUX0VOVklST05NRU5UUyxcclxuICAgICAgICApLFxyXG4gICAgICApLFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRJdGVtVGV4dChpdGVtOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgdGhpcy5tYXRjaGVkID0gdHJ1ZTtcclxuICAgIHJldHVybiBpdGVtO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG9uTm9TdWdnZXN0aW9uKCk6IHZvaWQge1xyXG4gICAgdGhpcy5tYXRjaGVkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb25DaG9vc2VJdGVtKGl0ZW06IHN0cmluZywgX2V2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLm1hdGNoZWQpIHtcclxuICAgICAgdGhpcy5jYWxsYmFjayhpdGVtKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY2FsbGJhY2sodGhpcy5pbnB1dEVsLnZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHN0YXRpYyBjYWxsYmFjayhcclxuICAgIGFwcDogQXBwLFxyXG4gICAgc2V0dGluZ3M6IExhdGV4RW52aXJvbm1lbnRzU2V0dGluZ3MsXHJcbiAgICBkZWZhdWx0TmFtZTogc3RyaW5nLFxyXG4gICAgY2FsbDogKG5hbWU6IHN0cmluZykgPT4gdm9pZCxcclxuICApOiB2b2lkIHtcclxuICAgIG5ldyBFbnZNb2RhbChhcHAsIHNldHRpbmdzLCBkZWZhdWx0TmFtZSwgY2FsbCkub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCAiY29uc3QgRElTUExBWV9FUVVBVElPTlMgPSBbXHJcbiAgJ2VxdWF0aW9uJyxcclxuICAnZXF1YXRpb24qJyxcclxuICAnZ2F0aGVyJyxcclxuICAnZ2F0aGVyKicsXHJcbiAgJ211bHRsaW5lJyxcclxuICAnbXVsdGxpbmUqJyxcclxuICAnc3BsaXQnLFxyXG4gICdhbGlnbicsXHJcbiAgJ2FsaWduKicsXHJcbiAgJ2ZsYWxpZ24nLFxyXG4gICdmbGFsaWduKicsXHJcbiAgJ2FsaWduYXQnLFxyXG4gICdhbGlnbmF0KicsXHJcbl07XHJcblxyXG5jb25zdCBNQVRSSUNFUyA9IFtcclxuICAnbWF0cml4JyxcclxuICAncG1hdHJpeCcsXHJcbiAgJ2JtYXRyaXgnLFxyXG4gICdCbWF0cml4JyxcclxuICAndm1hdHJpeCcsXHJcbiAgJ1ZtYXRyaXgnLFxyXG4gICdzbWFsbG1hdHJpeCcsXHJcbl07XHJcblxyXG5jb25zdCBTVUJfRU5WSVJPTk1FTlRTID0gWydtdWx0bGluZWQnLCAnZ2F0aGVyZWQnLCAnYWxpZ25lZCcsICdjYXNlcyddO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfRU5WSVJPTk1FTlRTID0gW1xyXG4gIC4uLkRJU1BMQVlfRVFVQVRJT05TLFxyXG4gIC4uLk1BVFJJQ0VTLFxyXG4gIC4uLlNVQl9FTlZJUk9OTUVOVFMsXHJcbl07XHJcbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBMYXRleEVudmlyb25tZW50cyBmcm9tICcuL21haW4nO1xyXG5cclxuZXhwb3J0IGNsYXNzIExhdGV4RW52aXJvbm1lbnRzU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcGx1Z2luOiBMYXRleEVudmlyb25tZW50cztcclxuXHJcbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTGF0ZXhFbnZpcm9ubWVudHMpIHtcclxuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcblxyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdTZXR0aW5ncyBmb3IgbGF0ZXggZW52aXJvbm1lbnRzJyB9KTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ0RlZmF1bHQgZW52aXJvbm1lbnQnKVxyXG4gICAgICAuc2V0RGVzYygnVGhlIGRlZmF1bHQgZW52aXJvbm1lbnQgdG8gaW5zZXJ0JylcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdlbnZpcm9ubWVudCcpXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdEVudmlyb25tZW50KVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0RW52aXJvbm1lbnQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgfSksXHJcbiAgICAgICk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdFeHRyYSBlbnZpcm9ubWVudHMnKVxyXG4gICAgICAuc2V0RGVzYyhcclxuICAgICAgICAnRW52aXJvbm1lbnQgbmFtZXMgdG8gYmUgc3VnZ2VzdGVkIGZvciBjb21wbGV0aW9uIChvbmUgcGVyIGxpbmUpJyxcclxuICAgICAgKVxyXG4gICAgICAuYWRkVGV4dEFyZWEoKGFyZWEpID0+IHtcclxuICAgICAgICBhcmVhXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tRW52aXJvbm1lbnRzLmpvaW4oJ1xcbicpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21FbnZpcm9ubWVudHMgPSB2YWx1ZVxyXG4gICAgICAgICAgICAgIC5zcGxpdCgnXFxuJylcclxuICAgICAgICAgICAgICAubWFwKCh4KSA9PiB4LnRyaW0oKSlcclxuICAgICAgICAgICAgICAuZmlsdGVyKCh4KSA9PiB4Lmxlbmd0aCA+IDApO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBFZGl0b3JUcmFuc2FjdGlvbiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgRWRpdG9yTGlrZSB9IGZyb20gJy4uL2VkaXRvckxpa2UnO1xyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IocHVibGljIGRvYzogRWRpdG9yTGlrZSkge31cclxuICBhYnN0cmFjdCBwcmVwYXJlKCk6IEFjdGlvbjtcclxuICBhYnN0cmFjdCB0cmFuc2FjdGlvbihlbnZOYW1lOiBzdHJpbmcpOiBFZGl0b3JUcmFuc2FjdGlvbjtcclxuICBwdWJsaWMgc3VnZ2VzdE5hbWUoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IG5lZWRzTmFtZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgRWRpdG9yVHJhbnNhY3Rpb24sIEVkaXRvclBvc2l0aW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBFZGl0b3JMaWtlIH0gZnJvbSAnLi9lZGl0b3JMaWtlJztcclxuaW1wb3J0IHsgTWF0aEJsb2NrIH0gZnJvbSAnLi9tYXRoYmxvY2snO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBQb3NSYW5nZSB7XHJcbiAgZnJvbTogbnVtYmVyO1xyXG4gIHRvOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRW52aXJvbm1lbnQge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBiZWdpbjogUG9zUmFuZ2U7XHJcbiAgZW5kOiBQb3NSYW5nZTtcclxuICBjb250ZW50czogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbmV3RW52aXJvbm1lbnQoXHJcbiAgbmFtZTogc3RyaW5nLFxyXG4gIGN1cnNvcjogRWRpdG9yUG9zaXRpb24sXHJcbiAgY29udGVudHM6IHN0cmluZyA9ICcnLFxyXG4pOiBFZGl0b3JUcmFuc2FjdGlvbiB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcGxhY2VTZWxlY3Rpb246IGBcXFxcYmVnaW57JHtuYW1lfX0ke3BhZENvbnRlbnRzKFxyXG4gICAgICBjb250ZW50cyxcclxuICAgICAgdHJ1ZSxcclxuICAgICl9XFxcXGVuZHske25hbWV9fWAsXHJcbiAgICBzZWxlY3Rpb246IHtcclxuICAgICAgZnJvbToge1xyXG4gICAgICAgIGNoOiAwLFxyXG4gICAgICAgIGxpbmU6IGN1cnNvci5saW5lICsgMSwgLy8gbW92ZSBvdXIgY2FyZXQgdG8ganVzdCBiZWZvcmUgdGhlIGJlZ2lubmluZyBvZiBjb250ZW50c1xyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gd3JhcFNlbGVjdGlvbihcclxuICBuYW1lOiBzdHJpbmcsXHJcbiAgY3Vyc29yOiBFZGl0b3JQb3NpdGlvbixcclxuICBjb250ZW50czogc3RyaW5nID0gJycsXHJcbik6IEVkaXRvclRyYW5zYWN0aW9uIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVwbGFjZVNlbGVjdGlvbjogYFxcXFxiZWdpbnske25hbWV9fSR7cGFkQ29udGVudHMoY29udGVudHMpfVxcXFxlbmR7JHtuYW1lfX1gLFxyXG4gICAgc2VsZWN0aW9uOiB7XHJcbiAgICAgIGZyb206IHtcclxuICAgICAgICBjaDogMCxcclxuICAgICAgICBsaW5lOiBjdXJzb3IubGluZSArIDEsIC8vIG1vdmUgb3VyIGNhcmV0IHRvIGp1c3QgYmVmb3JlIHRoZSBiZWdpbm5pbmcgb2YgY29udGVudHNcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBCbG9jayhcclxuICBuYW1lOiBzdHJpbmcsXHJcbiAgZG9jOiBFZGl0b3JMaWtlLFxyXG4gIGJsb2NrOiBNYXRoQmxvY2ssXHJcbik6IEVkaXRvclRyYW5zYWN0aW9uIHtcclxuICBjb25zdCBibG9ja1RleHQgPSBibG9jay50ZXh0LnNsaWNlKGJsb2NrLnN0YXJ0UG9zaXRpb24sIGJsb2NrLmVuZFBvc2l0aW9uKTtcclxuICAvLyBIYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIGN1cnNvciBvbiB0aGUgYmVnaW5uaW5nIGxpbmUgb2YgdGhlIGJsb2NrXHJcbiAgbGV0IGN1cnNvciA9IGRvYy5nZXRDdXJzb3IoKTtcclxuICBjb25zdCBzdGFydCA9IGRvYy5vZmZzZXRUb1BvcyhibG9jay5zdGFydFBvc2l0aW9uKTtcclxuICBpZiAoY3Vyc29yLmxpbmUgPT09IHN0YXJ0LmxpbmUpIHtcclxuICAgIGN1cnNvciA9IHtcclxuICAgICAgbGluZTogY3Vyc29yLmxpbmUgKyAxLFxyXG4gICAgICBjaDogYmxvY2tUZXh0Lmxlbmd0aCxcclxuICAgIH07XHJcbiAgfVxyXG4gIHJldHVybiB7XHJcbiAgICBjaGFuZ2VzOiBbXHJcbiAgICAgIHtcclxuICAgICAgICBmcm9tOiBkb2Mub2Zmc2V0VG9Qb3MoYmxvY2suc3RhcnRQb3NpdGlvbiksXHJcbiAgICAgICAgdG86IGRvYy5vZmZzZXRUb1BvcyhibG9jay5lbmRQb3NpdGlvbiksXHJcbiAgICAgICAgdGV4dDogYFxcXFxiZWdpbnske25hbWV9fSR7cGFkQ29udGVudHMoYmxvY2tUZXh0KX1cXFxcZW5keyR7bmFtZX19YCxcclxuICAgICAgfSxcclxuICAgIF0sXHJcbiAgICBzZWxlY3Rpb246IHsgZnJvbTogY3Vyc29yIH0sXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVud3JhcEVudmlyb25tZW50KFxyXG4gIGVudmlyb25tZW50OiBFbnZpcm9ubWVudCxcclxuICBkb2M6IEVkaXRvckxpa2UsXHJcbik6IEVkaXRvclRyYW5zYWN0aW9uIHtcclxuICBsZXQgY3Vyc29yID0gZG9jLmdldEN1cnNvcigpO1xyXG4gIGlmIChqdXN0V2hpdGVzcGFjZShlbnZpcm9ubWVudC5jb250ZW50cy5zcGxpdCgnXFxuJywgMSlbMF0pKSB7XHJcbiAgICAvLyBJZiB0aGUgZmlyc3QgbGluZSBvZiB0aGUgZW52aXJvbm1lbnQgaXMganVzdCB3aGl0ZXNwYWNlLCB3ZSdsbFxyXG4gICAgLy8gbW92ZSB0aGUgY3Vyc29yIHRvIHRoZSBmb2xsb3dpbmcgbGluZVxyXG4gICAgY3Vyc29yID0ge1xyXG4gICAgICBsaW5lOiBjdXJzb3IubGluZSAtIDEsXHJcbiAgICAgIGNoOiBjdXJzb3IuY2ggKyBkb2Mub2Zmc2V0VG9Qb3MoZW52aXJvbm1lbnQuYmVnaW4uZnJvbSkuY2gsXHJcbiAgICB9O1xyXG4gIH1cclxuICByZXR1cm4ge1xyXG4gICAgY2hhbmdlczogW1xyXG4gICAgICB7XHJcbiAgICAgICAgdGV4dDogdHJpbShlbnZpcm9ubWVudC5jb250ZW50cyksXHJcbiAgICAgICAgZnJvbTogZG9jLm9mZnNldFRvUG9zKGVudmlyb25tZW50LmJlZ2luLmZyb20pLFxyXG4gICAgICAgIHRvOiBkb2Mub2Zmc2V0VG9Qb3MoZW52aXJvbm1lbnQuZW5kLnRvKSxcclxuICAgICAgfSxcclxuICAgIF0sXHJcbiAgICBzZWxlY3Rpb246IHsgZnJvbTogY3Vyc29yIH0sXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoYW5nZUVudmlyb25tZW50KFxyXG4gIGVudmlyb25tZW50OiBFbnZpcm9ubWVudCxcclxuICBkb2M6IEVkaXRvckxpa2UsXHJcbiAgbmFtZTogc3RyaW5nLFxyXG4pOiBFZGl0b3JUcmFuc2FjdGlvbiB7XHJcbiAgY29uc3QgY2hhbmdlID0ge1xyXG4gICAgdGV4dDogYFxcXFxiZWdpbnske25hbWV9fSR7ZW52aXJvbm1lbnQuY29udGVudHN9XFxcXGVuZHske25hbWV9fWAsXHJcbiAgICBmcm9tOiBkb2Mub2Zmc2V0VG9Qb3MoZW52aXJvbm1lbnQuYmVnaW4uZnJvbSksXHJcbiAgICB0bzogZG9jLm9mZnNldFRvUG9zKGVudmlyb25tZW50LmVuZC50byksXHJcbiAgfTtcclxuICByZXR1cm4ge1xyXG4gICAgY2hhbmdlczogW2NoYW5nZV0sXHJcbiAgICBzZWxlY3Rpb246IHsgZnJvbTogZG9jLmdldEN1cnNvcigpIH0sXHJcbiAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gcGFkQ29udGVudHMoY29udGVudHM6IHN0cmluZywgcGFkRW1wdHk6IGJvb2xlYW4gPSBmYWxzZSk6IHN0cmluZyB7XHJcbiAgY29uc3QgbGluZXMgPSBjb250ZW50cy5zcGxpdCgnXFxuJyk7XHJcbiAgcmV0dXJuIGAke2dldFBhZChsaW5lc1swXSwgcGFkRW1wdHkpfSR7Y29udGVudHN9JHtnZXRQYWQoXHJcbiAgICBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXSxcclxuICAgIHBhZEVtcHR5LFxyXG4gICl9YDtcclxufVxyXG5cclxuZnVuY3Rpb24ganVzdFdoaXRlc3BhY2UodGV4dDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHRleHQubWF0Y2goL15bIFxcdF0qJC8pICE9IG51bGw7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFBhZCh0ZXh0OiBzdHJpbmcsIHBhZEVtcHR5OiBib29sZWFuID0gZmFsc2UpOiBzdHJpbmcge1xyXG4gIGlmICh0ZXh0Lmxlbmd0aCA9PT0gMCAmJiBwYWRFbXB0eSkgcmV0dXJuICdcXG4nO1xyXG4gIGlmICh0ZXh0Lmxlbmd0aCA9PT0gMCB8fCBqdXN0V2hpdGVzcGFjZSh0ZXh0KSkgcmV0dXJuICcnO1xyXG4gIHJldHVybiAnXFxuJztcclxufVxyXG5cclxuZnVuY3Rpb24gdHJpbSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGlmICh0ZXh0Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHRleHQ7XHJcbiAgY29uc3Qgc3RhcnQgPSB0ZXh0LnN0YXJ0c1dpdGgoJ1xcbicpID8gMSA6IDA7XHJcbiAgY29uc3QgZW5kID0gdGV4dC5lbmRzV2l0aCgnXFxuJykgPyB0ZXh0Lmxlbmd0aCAtIDEgOiB0ZXh0Lmxlbmd0aDtcclxuICByZXR1cm4gdGV4dC5zbGljZShzdGFydCwgZW5kKTtcclxufVxyXG4iLCAiZXhwb3J0IGNsYXNzIFNlYXJjaEN1cnNvciB7XHJcbiAgcHVibGljIHJlYWRvbmx5IHJlZ2V4OiBSZWdFeHA7XHJcbiAgcHJpdmF0ZSBfZnJvbTogbnVtYmVyO1xyXG4gIHByaXZhdGUgX3RvOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBfY2FyZXQ6IG51bWJlcjtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgdGV4dDogc3RyaW5nLFxyXG4gICAgcmVnZXg6IFJlZ0V4cCB8IFN0cmluZyxcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX29yaWdpbmFsQ2FyZXQ6IG51bWJlcixcclxuICApIHtcclxuICAgIGlmIChyZWdleCBpbnN0YW5jZW9mIFJlZ0V4cCkge1xyXG4gICAgICB0aGlzLnJlZ2V4ID0gcmVnZXg7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnJlZ2V4ID0gbmV3IFJlZ0V4cChyZWdleCBhcyBzdHJpbmcpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5fZnJvbSA9IHRoaXMuX29yaWdpbmFsQ2FyZXQ7XHJcbiAgICB0aGlzLl90byA9IHRoaXMuX29yaWdpbmFsQ2FyZXQ7XHJcbiAgICB0aGlzLl9jYXJldCA9IHRoaXMuX29yaWdpbmFsQ2FyZXQ7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZmluZE5leHQoKTogUmVnRXhwTWF0Y2hBcnJheSB8IHVuZGVmaW5lZCB7XHJcbiAgICBjb25zdCB0ZXh0ID0gdGhpcy50ZXh0LnNsaWNlKHRoaXMuX2NhcmV0KTtcclxuICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaCh0aGlzLnJlZ2V4KTtcclxuICAgIGlmIChtYXRjaD8uaW5kZXggPT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fZnJvbSA9IHRoaXMuX2NhcmV0ICsgbWF0Y2guaW5kZXg7XHJcbiAgICB0aGlzLl90byA9IHRoaXMuX2NhcmV0ICsgbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGg7XHJcbiAgICB0aGlzLl9jYXJldCA9IHRoaXMuX3RvO1xyXG4gICAgcmV0dXJuIG1hdGNoO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGZpbmRQcmV2aW91cygpOiBSZWdFeHBNYXRjaEFycmF5IHwgdW5kZWZpbmVkIHtcclxuICAgIGNvbnN0IHJldmVyc2VSZWdleCA9IG5ldyBSZWdFeHAoXHJcbiAgICAgIGAoPzxmdWxsPiR7dGhpcy5yZWdleC5zb3VyY2V9KSg/IVtcXFxcc1xcXFxTXSpcXFxcazxmdWxsPilgLFxyXG4gICAgICB0aGlzLnJlZ2V4LmZsYWdzLFxyXG4gICAgKTtcclxuICAgIGNvbnN0IHRleHQgPSB0aGlzLnRleHQuc2xpY2UoMCwgdGhpcy5fY2FyZXQpO1xyXG4gICAgY29uc3QgbGFzdE1hdGNoID0gdGV4dC5tYXRjaChyZXZlcnNlUmVnZXgpO1xyXG4gICAgaWYgKGxhc3RNYXRjaD8uaW5kZXggPT0gbnVsbCB8fCBsYXN0TWF0Y2g/Lmdyb3VwcyA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9mcm9tID0gbGFzdE1hdGNoLmluZGV4O1xyXG4gICAgdGhpcy5fdG8gPSBsYXN0TWF0Y2guaW5kZXggKyBsYXN0TWF0Y2guZ3JvdXBzLmZ1bGwubGVuZ3RoO1xyXG4gICAgdGhpcy5fY2FyZXQgPSB0aGlzLl9mcm9tO1xyXG4gICAgcmV0dXJuIGxhc3RNYXRjaDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyB0bygpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuX3RvO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGZyb20oKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLl9mcm9tO1xyXG4gIH1cclxufVxyXG5cclxuLy8gaW50ZXJmYWNlIE1hdGNoIHtcclxuLy8gICBpbmRleDogbnVtYmVyO1xyXG4vLyAgIHRleHQ6IHN0cmluZztcclxuLy8gfVxyXG4vL1xyXG4vLyBmdW5jdGlvbiBnZXRMYXN0TWF0Y2gocjogUmVnRXhwLCBzOiBzdHJpbmcpOiBNYXRjaCB8IHVuZGVmaW5lZCB7XHJcbi8vICAgcy5tYXRjaChyKTtcclxuLy8gICBjb25zdCBtYXRjaGVzID0gQXJyYXkuZnJvbShtYXRjaEFsbChyLCBzKSk7XHJcbi8vICAgY29uc3QgbGFzdE1hdGNoID0gbWF0Y2hlc1ttYXRjaGVzLmxlbmd0aCAtIDFdO1xyXG4vLyAgIGlmIChsYXN0TWF0Y2ggPT0gbnVsbCkge1xyXG4vLyAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuLy8gICB9IGVsc2Uge1xyXG4vLyAgICAgcmV0dXJuIHtcclxuLy8gICAgICAgaW5kZXg6IGxhc3RNYXRjaC5pbmRleCxcclxuLy8gICAgICAgdGV4dDogbGFzdE1hdGNoWzBdLFxyXG4vLyAgICAgfTtcclxuLy8gICB9XHJcbi8vIH1cclxuIiwgImltcG9ydCB7IEVudmlyb25tZW50IH0gZnJvbSAnLi9lbnZpcm9ubWVudCc7XHJcbmltcG9ydCB7IFNlYXJjaEN1cnNvciB9IGZyb20gJy4vc2VhcmNoJztcclxuaW1wb3J0IHsgRWRpdG9yIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1hdGhCbG9jayB7XHJcbiAgcmVhZG9ubHkgc3RhcnRQb3NpdGlvbjogbnVtYmVyO1xyXG4gIHJlYWRvbmx5IGVuZFBvc2l0aW9uOiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyByZWFkb25seSB0ZXh0OiBzdHJpbmcsIGN1cnNvcjogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBzZWFyY2hDdXJzb3IgPSBuZXcgU2VhcmNoQ3Vyc29yKHRleHQsICdcXFxcJFxcXFwkJywgY3Vyc29yKTtcclxuICAgIHRoaXMuc3RhcnRQb3NpdGlvbiA9XHJcbiAgICAgIHNlYXJjaEN1cnNvci5maW5kUHJldmlvdXMoKSAhPSBudWxsID8gc2VhcmNoQ3Vyc29yLnRvKCkgOiAwO1xyXG4gICAgc2VhcmNoQ3Vyc29yLnJlc2V0KCk7XHJcbiAgICB0aGlzLmVuZFBvc2l0aW9uID1cclxuICAgICAgc2VhcmNoQ3Vyc29yLmZpbmROZXh0KCkgIT0gbnVsbCA/IHNlYXJjaEN1cnNvci5mcm9tKCkgOiB0ZXh0Lmxlbmd0aDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRFbmNsb3NpbmdFbnZpcm9ubWVudChjdXJzb3I6IG51bWJlcik6IEVudmlyb25tZW50IHwgdW5kZWZpbmVkIHtcclxuICAgIGNvbnN0IGJlZ2luRW5kcyA9IG5ldyBCZWdpbkVuZHMoXHJcbiAgICAgIHRoaXMudGV4dCxcclxuICAgICAgdGhpcy5zdGFydFBvc2l0aW9uLFxyXG4gICAgICB0aGlzLmVuZFBvc2l0aW9uLFxyXG4gICAgKTtcclxuICAgIGNvbnN0IGVudmlyb25tZW50cyA9IEFycmF5LmZyb20oYmVnaW5FbmRzKTtcclxuXHJcbiAgICBpZiAoYmVnaW5FbmRzLmlzT3Blbikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3VuY2xvc2VkIGVudmlyb25tZW50cyBpbiBibG9jaycpO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgc3RhcnQgPSBlbnZpcm9ubWVudHNcclxuICAgICAgLmZpbHRlcigoZW52KSA9PiBlbnYudHlwZSA9PT0gJ2JlZ2luJyAmJiBlbnYuZnJvbSA8IGN1cnNvcilcclxuICAgICAgLnBvcCgpO1xyXG5cclxuICAgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYWZ0ZXIgPSBlbnZpcm9ubWVudHMuZmlsdGVyKChlbnYpID0+IGVudi5mcm9tID4gc3RhcnQudG8pO1xyXG5cclxuICAgIGxldCBvcGVuID0gMTtcclxuICAgIGxldCBlbmQ6IEJlZ2luRW5kIHwgdW5kZWZpbmVkO1xyXG4gICAgZm9yIChjb25zdCBlbnYgb2YgYWZ0ZXIpIHtcclxuICAgICAgaWYgKGVudi50eXBlID09PSAnYmVnaW4nKSB7XHJcbiAgICAgICAgb3BlbisrO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG9wZW4tLTtcclxuICAgICAgICBpZiAob3BlbiA9PT0gMCkge1xyXG4gICAgICAgICAgZW5kID0gZW52O1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignY3VycmVudCBlbnZpcm9ubWVudCBpcyBuZXZlciBjbG9zZWQnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZW5kLnRvIDwgY3Vyc29yKSB7XHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogc3RhcnQubmFtZSxcclxuICAgICAgYmVnaW46IHN0YXJ0LFxyXG4gICAgICBlbmQsXHJcbiAgICAgIGNvbnRlbnRzOiB0aGlzLnRleHQuc2xpY2Uoc3RhcnQudG8sIGVuZC5mcm9tKSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGlzTWF0aE1vZGUoX2N1cnNvcjogbnVtYmVyLCBfZWRpdG9yOiBFZGl0b3IpOiBib29sZWFuIHtcclxuICAgIC8vIGNvbnN0IHRva2VuID0gZWRpdG9yLmdldFRva2VuQXQoY3Vyc29yKTtcclxuICAgIC8vIGNvbnN0IHN0YXRlID0gdG9rZW4uc3RhdGU7XHJcbiAgICAvLyByZXR1cm4gc3RhdGUuaG1kSW5uZXJTdHlsZSA9PT0gJ21hdGgnO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG59XHJcblxyXG5pbnRlcmZhY2UgQmVnaW5FbmQge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB0eXBlOiAnYmVnaW4nIHwgJ2VuZCc7XHJcbiAgZnJvbTogbnVtYmVyO1xyXG4gIHRvOiBudW1iZXI7XHJcbn1cclxuXHJcbmNsYXNzIEJlZ2luRW5kcyBpbXBsZW1lbnRzIEl0ZXJhYmxlSXRlcmF0b3I8QmVnaW5FbmQ+IHtcclxuICBwcml2YXRlIHJlYWRvbmx5IG9wZW5FbnZzOiBCZWdpbkVuZFtdID0gW107XHJcbiAgcHJpdmF0ZSBzZWFyY2g6IFNlYXJjaEN1cnNvcjtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHJlYWRvbmx5IHRleHQ6IHN0cmluZyxcclxuICAgIHJlYWRvbmx5IHN0YXJ0OiBudW1iZXIsXHJcbiAgICByZWFkb25seSBlbmQ6IG51bWJlcixcclxuICApIHtcclxuICAgIHRoaXMuc2VhcmNoID0gdGhpcy5nZXRFbnZDdXJzb3IodGhpcy5zdGFydCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnNlYXJjaCA9IHRoaXMuZ2V0RW52Q3Vyc29yKHRoaXMuc3RhcnQpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRFbnZDdXJzb3Ioc3RhcnQ6IG51bWJlcik6IFNlYXJjaEN1cnNvciB7XHJcbiAgICByZXR1cm4gbmV3IFNlYXJjaEN1cnNvcihcclxuICAgICAgdGhpcy50ZXh0LFxyXG4gICAgICAvXFxcXCg/PGJlZ2luRW5kPmJlZ2lufGVuZCl7XFxzKig/PG5hbWU+W159XSspXFxzKn0vbSxcclxuICAgICAgc3RhcnQsXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBpc09wZW4oKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5vcGVuRW52cy5sZW5ndGggPiAwO1xyXG4gIH1cclxuXHJcbiAgW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmFibGVJdGVyYXRvcjxCZWdpbkVuZD4ge1xyXG4gICAgdGhpcy5yZXNldCgpO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBuZXh0KCk6IEl0ZXJhdG9yUmVzdWx0PEJlZ2luRW5kPiB7XHJcbiAgICBjb25zdCBtYXRjaCA9IHRoaXMuc2VhcmNoLmZpbmROZXh0KCk7XHJcbiAgICBjb25zdCB0byA9IHRoaXMuc2VhcmNoLnRvKCk7XHJcblxyXG4gICAgaWYgKG1hdGNoPy5ncm91cHMgPT0gbnVsbCB8fCB0byA+IHRoaXMuZW5kKSB7XHJcbiAgICAgIHJldHVybiB7IGRvbmU6IHRydWUsIHZhbHVlOiBudWxsIH07XHJcbiAgICB9XHJcblxyXG4gICAgc3dpdGNoIChtYXRjaC5ncm91cHMuYmVnaW5FbmQpIHtcclxuICAgICAgY2FzZSAnYmVnaW4nOiB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudDogQmVnaW5FbmQgPSB7XHJcbiAgICAgICAgICBuYW1lOiBtYXRjaC5ncm91cHMubmFtZSxcclxuICAgICAgICAgIHR5cGU6ICdiZWdpbicsXHJcbiAgICAgICAgICBmcm9tOiB0aGlzLnNlYXJjaC5mcm9tKCksXHJcbiAgICAgICAgICB0bzogdGhpcy5zZWFyY2gudG8oKSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub3BlbkVudnMucHVzaChjdXJyZW50KTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgZG9uZTogZmFsc2UsXHJcbiAgICAgICAgICB2YWx1ZTogY3VycmVudCxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2VuZCc6IHtcclxuICAgICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5vcGVuRW52cy5wb3AoKTtcclxuICAgICAgICBpZiAoY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Nsb3NpbmcgZW52aXJvbm1lbnQgd2hpY2ggd2FzIG5ldmVyIG9wZW5lZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3VycmVudC5uYW1lICE9PSBtYXRjaC5ncm91cHMubmFtZSkge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdlbnZpcm9ubWVudCBub3QgY2xvc2VkIHByb3Blcmx5Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBkb25lOiBmYWxzZSxcclxuICAgICAgICAgIHZhbHVlOiB7XHJcbiAgICAgICAgICAgIG5hbWU6IG1hdGNoLmdyb3Vwcy5uYW1lLFxyXG4gICAgICAgICAgICB0eXBlOiAnZW5kJyxcclxuICAgICAgICAgICAgZnJvbTogdGhpcy5zZWFyY2guZnJvbSgpLFxyXG4gICAgICAgICAgICB0bzogdGhpcy5zZWFyY2gudG8oKSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKGByZWdleCByZXR1cm5lZCB1bmV4cGVjdGVkIHJlc3VsdCAke21hdGNoWzFdfWApO1xyXG4gIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSAnLi9hY3Rpb24nO1xyXG5pbXBvcnQgeyB3cmFwU2VsZWN0aW9uLCB3cmFwQmxvY2sgfSBmcm9tICcuLi9lbnZpcm9ubWVudCc7XHJcbmltcG9ydCB7IEVkaXRvclRyYW5zYWN0aW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBNYXRoQmxvY2sgfSBmcm9tICcuLi9tYXRoYmxvY2snO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdyYXBBY3Rpb24gZXh0ZW5kcyBBY3Rpb24ge1xyXG4gIHByZXBhcmUoKTogQWN0aW9uIHtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgdHJhbnNhY3Rpb24oZW52TmFtZTogc3RyaW5nKTogRWRpdG9yVHJhbnNhY3Rpb24ge1xyXG4gICAgaWYgKHRoaXMuZG9jLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHtcclxuICAgICAgcmV0dXJuIHdyYXBTZWxlY3Rpb24oXHJcbiAgICAgICAgZW52TmFtZSxcclxuICAgICAgICB0aGlzLmRvYy5nZXRDdXJzb3IoKSxcclxuICAgICAgICB0aGlzLmRvYy5nZXRTZWxlY3Rpb24oKSxcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBibG9jayA9IG5ldyBNYXRoQmxvY2soXHJcbiAgICAgIHRoaXMuZG9jLmdldFZhbHVlKCksXHJcbiAgICAgIHRoaXMuZG9jLnBvc1RvT2Zmc2V0KHRoaXMuZG9jLmdldEN1cnNvcigpKSxcclxuICAgICk7XHJcbiAgICByZXR1cm4gd3JhcEJsb2NrKGVudk5hbWUsIHRoaXMuZG9jLCBibG9jayk7XHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBBY3Rpb24gfSBmcm9tICcuL2FjdGlvbic7XHJcbmltcG9ydCB7IFdyYXBBY3Rpb24gfSBmcm9tICcuL3dyYXBBY3Rpb24nO1xyXG5pbXBvcnQgeyBuZXdFbnZpcm9ubWVudCB9IGZyb20gJy4uL2Vudmlyb25tZW50JztcclxuaW1wb3J0IHsgRWRpdG9yVHJhbnNhY3Rpb24gfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5leHBvcnQgY2xhc3MgSW5zZXJ0QWN0aW9uIGV4dGVuZHMgQWN0aW9uIHtcclxuICBwcmVwYXJlKCk6IEFjdGlvbiB7XHJcbiAgICBpZiAodGhpcy5kb2Muc29tZXRoaW5nU2VsZWN0ZWQoKSkge1xyXG4gICAgICByZXR1cm4gbmV3IFdyYXBBY3Rpb24odGhpcy5kb2MpLnByZXBhcmUoKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgdHJhbnNhY3Rpb24oZW52TmFtZTogc3RyaW5nKTogRWRpdG9yVHJhbnNhY3Rpb24ge1xyXG4gICAgcmV0dXJuIG5ld0Vudmlyb25tZW50KGVudk5hbWUsIHRoaXMuZG9jLmdldEN1cnNvcigpKTtcclxuICB9XHJcbn1cclxuIiwgImltcG9ydCB7IEFjdGlvbiB9IGZyb20gJy4vYWN0aW9uJztcclxuaW1wb3J0IHsgTWF0aEJsb2NrIH0gZnJvbSAnLi4vbWF0aGJsb2NrJztcclxuaW1wb3J0IHsgY2hhbmdlRW52aXJvbm1lbnQsIEVudmlyb25tZW50IH0gZnJvbSAnLi4vZW52aXJvbm1lbnQnO1xyXG5pbXBvcnQgeyBXcmFwQWN0aW9uIH0gZnJvbSAnLi93cmFwQWN0aW9uJztcclxuaW1wb3J0IHsgRWRpdG9yVHJhbnNhY3Rpb24gfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5leHBvcnQgY2xhc3MgQ2hhbmdlQWN0aW9uIGV4dGVuZHMgQWN0aW9uIHtcclxuICBwcml2YXRlIGN1cnJlbnQ6IEVudmlyb25tZW50IHwgdW5kZWZpbmVkO1xyXG4gIHByaXZhdGUgbmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG5cclxuICBwdWJsaWMgc3VnZ2VzdE5hbWUoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiB0aGlzLm5hbWU7XHJcbiAgfVxyXG5cclxuICBwcmVwYXJlKCk6IEFjdGlvbiB7XHJcbiAgICBjb25zdCBjdXJzb3IgPSB0aGlzLmRvYy5wb3NUb09mZnNldCh0aGlzLmRvYy5nZXRDdXJzb3IoKSk7XHJcbiAgICBjb25zdCBibG9jayA9IG5ldyBNYXRoQmxvY2sodGhpcy5kb2MuZ2V0VmFsdWUoKSwgY3Vyc29yKTtcclxuICAgIHRoaXMuY3VycmVudCA9IGJsb2NrLmdldEVuY2xvc2luZ0Vudmlyb25tZW50KGN1cnNvcik7XHJcbiAgICBpZiAodGhpcy5jdXJyZW50ID09PSB1bmRlZmluZWQgfHwgdGhpcy5kb2Muc29tZXRoaW5nU2VsZWN0ZWQoKSkge1xyXG4gICAgICByZXR1cm4gbmV3IFdyYXBBY3Rpb24odGhpcy5kb2MpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5uYW1lID0gdGhpcy5jdXJyZW50Lm5hbWU7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIHRyYW5zYWN0aW9uKGVudk5hbWU6IHN0cmluZyk6IEVkaXRvclRyYW5zYWN0aW9uIHtcclxuICAgIGlmICh0aGlzLmN1cnJlbnQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICByZXR1cm4gY2hhbmdlRW52aXJvbm1lbnQodGhpcy5jdXJyZW50LCB0aGlzLmRvYywgZW52TmFtZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge307XHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBBY3Rpb24gfSBmcm9tICcuL2FjdGlvbic7XHJcbmltcG9ydCB7IE1hdGhCbG9jayB9IGZyb20gJy4uL21hdGhibG9jayc7XHJcbmltcG9ydCB7IEVudmlyb25tZW50LCB1bndyYXBFbnZpcm9ubWVudCB9IGZyb20gJy4uL2Vudmlyb25tZW50JztcclxuaW1wb3J0IHsgRWRpdG9yVHJhbnNhY3Rpb24gfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5leHBvcnQgY2xhc3MgRGVsZXRlQWN0aW9uIGV4dGVuZHMgQWN0aW9uIHtcclxuICBwcml2YXRlIGN1cnJlbnQ6IEVudmlyb25tZW50IHwgdW5kZWZpbmVkO1xyXG5cclxuICBwdWJsaWMgZ2V0IG5lZWRzTmFtZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIHByZXBhcmUoKTogQWN0aW9uIHtcclxuICAgIGNvbnN0IGN1cnNvciA9IHRoaXMuZG9jLmdldEN1cnNvcigpO1xyXG4gICAgY29uc3QgYmxvY2sgPSBuZXcgTWF0aEJsb2NrKFxyXG4gICAgICB0aGlzLmRvYy5nZXRWYWx1ZSgpLFxyXG4gICAgICB0aGlzLmRvYy5wb3NUb09mZnNldChjdXJzb3IpLFxyXG4gICAgKTtcclxuICAgIHRoaXMuY3VycmVudCA9IGJsb2NrLmdldEVuY2xvc2luZ0Vudmlyb25tZW50KHRoaXMuZG9jLnBvc1RvT2Zmc2V0KGN1cnNvcikpO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICB0cmFuc2FjdGlvbihfZW52TmFtZTogc3RyaW5nKTogRWRpdG9yVHJhbnNhY3Rpb24ge1xyXG4gICAgaWYgKHRoaXMuY3VycmVudCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHJldHVybiB1bndyYXBFbnZpcm9ubWVudCh0aGlzLmN1cnJlbnQsIHRoaXMuZG9jKTtcclxuICAgIH1cclxuICAgIHJldHVybiB7fTtcclxuICB9XHJcbn1cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQSx1QkFBcUQ7OztBQ0E5QyxzQ0FBZ0M7QUFBQSxFQUFoQyxjQUFQO0FBQ1MsOEJBQXFCO0FBQ3JCLDhCQUErQjtBQUFBO0FBQUE7QUFLakMsd0JBQ0wsUUFDMkI7QUFUN0I7QUFVRSxRQUFNLFdBQVcsSUFBSTtBQUVyQixXQUFTLHFCQUNQLGFBQU8sdUJBQVAsWUFBNkIsU0FBUztBQUV4QyxXQUFTLHFCQUNQLGFBQU8sdUJBQVAsWUFBNkIsU0FBUztBQUV4QyxTQUFPO0FBQUE7OztBQ2xCVCxzQkFBdUM7OztBQ0F2QyxJQUFNLG9CQUFvQjtBQUFBLEVBQ3hCO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUE7QUFHRixJQUFNLFdBQVc7QUFBQSxFQUNmO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUE7QUFHRixJQUFNLG1CQUFtQixDQUFDLGFBQWEsWUFBWSxXQUFXO0FBRXZELElBQU0sdUJBQXVCO0FBQUEsRUFDbEMsR0FBRztBQUFBLEVBQ0gsR0FBRztBQUFBLEVBQ0gsR0FBRztBQUFBOzs7QUQzQkUsNkJBQXVCLGtDQUEwQjtBQUFBLEVBRXRELFlBQ0UsS0FDaUIsVUFDQSxNQUNBLFVBQ2pCO0FBQ0EsVUFBTTtBQUpXO0FBQ0E7QUFDQTtBQUxYLG1CQUFtQjtBQVF6QixTQUFLLGdCQUFnQjtBQUFBLE1BQ25CLEVBQUUsU0FBUyxnQkFBTSxTQUFT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
