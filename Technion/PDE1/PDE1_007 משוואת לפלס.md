---
aliases:
  - משוואת לפלס
  - פונקציה הרמונית
  - משוואת פואסון
  - בעיית דיריכלה
  - בעיית פואסון
  - בעיית רובין
  - זהות גרין
---
# הקדמה

## משוואות לפלס ופואסון

משוואת החום החד-ממדית היא מהצורה:
$$u_{t}=k^{2}u_{xx}$$
בדו-ממד היא מהצורה:
$$u_{t}=k^{2}(u_{xx}+u_{yy})$$
אם $u_{t}=0$, אנו נקבל את המשוואה הבאה, הנקראת **משוואת לפלס**:

>[!def] הגדרה: 
 >**משוואת לפלס** היא משוואה הנתונה ע"י:
$$\Delta u=u_{xx}+u_{yy}=0$$

>[!notes] הערות: 
 >1. פונקציה $u$ שמקיימת את המשוואה נקראת **פונקציה הרמונית**.
 >2. האופרטור $\Delta$ נקרא **לפלסיאן**.
 >3. משוואת לפלס היא [[PDE1_003 משוואות לינאריות מסדר שני#מיון משוואות מסדר שני בשני משתנים|משוואה אליפטית]]. חלק מהמושגים ודרכי הפתרון כאן ניתן באמת להרחיב למשוואות אליפטיות, אך לא נעסוק בהן (תודה לאל).

משוואה כללית יותר נתונה ע"י:
>[!def] הגדרה: 
**משוואת פואסון** היא משוואה הנתונה ע"י:
$$\Delta u=F(x,y)$$

ניתן לבעיות שנעסוק בהן פירוש פיזיקלי פשוט. פתרון משוואת פואסון מייצג את הטמפרטורה $u$ בתחום $D$ במצב שיווי משקל. האיבר הלא הומוגני $F$ מתאר (למעט הסימן) את קצב ייצור החום ב-$D$. על מנת לקבל פילוג חום יחיד ב-$D$ עלינו לספק מידע על החום (או שטף החום) על שפת התחום $\partial D$. קיימים מספר תנאי שפה טיפוסיים לבעיות אלו:

## סיווג בעיות
>[!def] הגדרה: 
 >**בעיית דיריכלה** היא בעיה המוגדרת ע"י משוואת פואסון ותנאי השפה מסוג [[PDE1_001 הקדמה ומשוואות מסדר ראשון#תנאי שפה|דיריכלה]] בתחום $D$ עבור פונקציה נתונה $g$:
 >$$u(x,y)=g(x,y),\, \quad \quad (x,y)\in \partial D$$
 >כאשר $\partial D$ הוא שפת התחום $D$.

![[PDE7/PDE1_007 משוואת לפלס 2024-03-26 19.11.13.excalidraw.svg|400]]
%%[[PDE7/PDE1_007 משוואת לפלס 2024-03-26 19.11.13.excalidraw|🖋 Edit in Excalidraw]]%%
>שרטוט סכמתי של בעיית דיריכלה עבור משוואת פואסון.

>[!def] הגדרה: 
 >**בעיית נוימן** היא בעיה המוגדרת ע"י משוואת פואסון ותנאי השפה מסוג [[PDE1_001 הקדמה ומשוואות מסדר ראשון#תנאי שפה|נוימן]] בתחום $D$ עבור פונקציה נתונה $g$:
 >$$\partial_{n}u(x,y)=g(x,y),\, \quad \quad (x,y)\in \partial D$$
 >כאשר $\partial D$ הוא שפת התחום $D$, $\hat{n}$ מסמן את נורמל היחידה החיצוני ל-$D$, ו-$\partial_{n}$ מסמן [[../CAL2/CAL2_007 נגזרות מכוונות וגרדיאנט#נגזרת מכוונת|נגזרת מכוונת]] בכיוון $\hat{n}$.
 
 >[!def] הגדרה: 
 >**בעיית רובין** היא בעיה המוגדרת ע"י משוואת פואסון ותנאי השפה מהסוג השלישי:
 >$$u(x,y)+\alpha(x,y)\partial_{n}u=g(x,y)$$
 >כאשר $\alpha,g$ הן פונקציות נתונות.

 
# בעיית דיריכלה במלבן

בעיית דיריכלה במלבן נתון ע"י:
$$\begin{aligned}
 & \Delta u=0 &  & 0<x<a,\, 0<y<b \\
 & u_{}(x,0)={f}_{1}(x)  &  & 0\leq x\leq a\\
 & u_{}(x,b)={f}_{2}(x)  &  & 0\leq x\leq a\\
 & u_{}(0,y)={g}_{1}(y)  &  & 0\leq y\leq b\\
 & u_{}(a,y)={g}_{2}(y) &  & 0\leq y\leq b
\end{aligned}$$

![[PDE7/PDE1_007 משוואת לפלס 2024-03-26 18.50.22.excalidraw.svg]]
%%[[PDE7/PDE1_007 משוואת לפלס 2024-03-26 18.50.22.excalidraw|🖋 Edit in Excalidraw]]%%

נזכור שחשוב לבדוק עבורה תנאי תואמות אם אנו מעוניינים בפתרון אמיתי. כלומר, צריך לבדוק שוויון בין הפונקציות בכל ארבעת הפינות.

כדי לפתור את בעיה זו, נוכל לפצלה ל-2 בעיות שונות עם תנאי שפה הומוגניים כך שנוכל לפתור אותה בעזרת שיטת הפרדת המשתנים. לאחר מכן, נסכום את שתי הפתרונות ע"פ עקרון הסופרפוזיציה.
כדי שתנאי השפה שלנו בכל בעיה באמת יהיו הומוגניים נבצע את הפיצול באופן הבא:

1. אם $u$ לא רציפה על השפה, אז נפצל ל-2 בעיות ונפתור.
2. אם $u$ רציפה על השפה ובכל 4 הפינות מתאפסת, אז נפצל ל-2 בעיות ונפתור.
3. אם $u$ רציפה על השפה וקיימת לפחות פינה אחת שבה היא לא מתאפסת, אז לפני הפיצול ל-2 בעיות נאפס פינות.

מצב 3 הוא יותר מסובך לפתרון, כי אנו נדרשים לאפס את הפינות. כדי לעשות זאת, נשתמש בפולינום הרמוני, שבעזרתו נגדיר את הבעיה מחדש. מאחר והאופרטור לפלסיאן הוא אופרטור לינארי, כאשר נגדיר את הבעיה מחדש, עדיין נקבל משוואת לפלס הרמונית. הפולינום ההרמוני שנשתמש בו יהיה:
$$p(x,y)=a+bx+cy+dxy+k(x^{2}-y^{2})$$
הוא הרמוני כיוון ש- $\Delta p=0$.
הבעיה החדשה תוגדר עבור $z$, כאשר:
$$\boxed {
z=u-p
 }$$
 ונדרוש שעבור $z$ כל ארבעת הפינות מתאפסות. ללא הגבלת הכלליות, הדרישה הזאת תורמת ארבעה אילוצים בלבד, ולכן נוכל להניח ש- $k=0$. לכן הפולינום שלנו הופך להיות פשוטה:
 $$p(x,y)=a+bx+cy+dxy$$


 --- 
 
 **תרגיל:** 
 נתונה הבעיית דיריכלה:
 $$\begin{aligned}
 & \Delta u=0 & &  0<x<\pi,\, 0<y<1 \\
 & u(x,0)=x(\pi-x) &  & 0\leq x\leq \pi \\
 & u(x,1)=x  & & 0\leq x\leq \pi\\
 & u(0,y)=\sin(3\pi y)  &  & 0\leq y\leq 1\\
 & u(\pi,y)=\pi y &  & 0\leq y\leq 1
\end{aligned}$$
פתרו את הבעיה.

**פתרון:**
נשים לב כי במקרה זה:
$$\begin{aligned}
 & {f}_{1,2}\in C[0,\pi] \\
 & g_{1,2}\in C[0,1]
\end{aligned}$$
הפינות:
$$\begin{aligned}
 & u(0,0)=u(\pi,0)=u(0,1)=0 \\[1ex]
 & u(\pi,1)=1
\end{aligned}$$
לכן, נדרש לאפס את הפינות. נשתמש בפולינום:
$$p(x,y)=a+bx+cy+dxy$$
נגדיר $z=u-p$, ונדרוש שבפינות הוא ייתאפס:
$$\begin{aligned}
 & z(0,0)=u(0,0)-p(0,0)=-a=0  &  & a=0\\
 & z(\pi,0)=u(\pi,0)-p(\pi,0)=-b\pi=0 &  & b=0 \\
 & z(0,1)=u(0,1)-p(0,1)=-c=0 &  & c=0 \\
 & z(\pi,1)=u(\pi,1)-p(\pi,1)=\pi-d\pi=0 & &  d=1
\end{aligned}$$
לכן הפולינום שלנו:
$$p(x,y)=xy$$
נבנה בעיה חדשה עבור $z$:
	$$\begin{aligned}
 & \Delta z=0 \\
 & z(x,0)=u(x,0)-p(x,0)=x(\pi-x) \\
 & z(x,1)=u(x,1)-p(x,1)=x-x=0 \\
 & z(0,y)=u(0,y)-p(0,y)=\sin(3\pi y) \\
 & z(\pi,y)=u(\pi,y)-p(\pi,y)=0
\end{aligned}$$
כעת נפצל לשתי בעיות, $u,w$, כאשר אנו מאפסים בכל בעיה זוג תנאי שפה שונים:
עבור $v$:
$$\begin{aligned}
 & \Delta v=0 \\
 & v(x,0)=x(\pi-x) \\
 & v(x,1)=0 \\
 & v(0,y)=v(\pi,y)=0
\end{aligned}$$
עבור $w$:
$$\begin{aligned}
 & \Delta w=0 \\
 & w(x,0)=w(x,1)=0 \\
 & w(0,y)=\sin(3\pi y) \\
 & w(\pi,y)=0
\end{aligned}$$
נפתור את הבעיה עבור $w$. הבעיית שטורם ליוביל שלנו:
$$\begin{gathered}
w(x,y)=X(x)Y(y) \\[2ex]
w_{xx}+w_{yy}=X''Y+XY''=0 \\[1ex]
\dfrac{X''}{X}=-\dfrac{Y''}{Y}=\lambda
\end{gathered}$$
נפתור עבור $Y$, כי עבור $Y$ יהיה לנו תנאי שפה הומוגניים:
$$Y(0)=Y(1)=0$$
לכן הבעיה שלנו:
$$\begin{aligned}
 & Y''+\lambda Y=0 \\
 & Y(0)=Y(1)=0
\end{aligned}$$
הפתרון שלה:
$$\begin{aligned}
 & \lambda_{}n =\left( \dfrac{n\pi}{L} \right)^{2}=(n\pi)^{2}  &  & n=1,2,\dots \\
 & Y_{n}(y)=\sin\left( \dfrac{n\pi y}{L} \right)=\sin(n\pi y) &  & n=1,2,\dots 
\end{aligned}$$
כדי למצוא את $X$, אנו יודעים כי:
$$\begin{gathered}
X''_{n}-\lambda_{n}X_{n}=0 \\[1ex]
X''-(n\pi)^{2}X_{n}=0
\end{gathered}$$
נראה צורת פתרון עבור המקרה הכללי הבא:
$$\begin{aligned}
 & X''_{n}-\lambda_{n}X_{n}=0 \\
\end{aligned}$$
נזכור שאם קיים ${\lambda}_{0}=0$, נפתור עבורו בנפרד את המד"ר.
$$X_{n}(x)=A_{n}\exp(\sqrt{ \lambda_{n} }x)+B_{n}\exp(-\sqrt{ \lambda_{n} }x)$$
נוכל לרשום את משוואה זו מחדש בעזרת בסיס של [[../BMA1/BMA1_008 פונקציות היפרבוליות#פונקציות היפרבוליות|פונקציות היפרבוליות]] (אנו יכולים לעשות זאת כי הפונקציות ההיפרבוליות הן בת"ל ביחס לאקספוננטים):
$$X_{n}(x)=A_{n}\cosh(\sqrt{ \lambda_{n} }x)+B_{n}\sinh(\sqrt{ \lambda_{n} }x)$$
במקרה הפרטי של תנאי שפה דיריכלה (עבור $X$):
$$X_{n}(x)=A_{n}\sinh(\sqrt{ \lambda_{n} }x)+B_{n}\sinh(\sqrt{ \lambda_{n} }(a-x))$$
במקרה הפרטי של תנאי שפה נוימן (עבור $X$):
$$X_{n}(x)=A_{n}\cosh(\sqrt{ \lambda_{n} }x)+B_{n}\cosh(\sqrt{ \lambda_{n} }(a-x))$$
	נכשל בקורס נודר נדר (אופיר רובין מנסח בעיית רובין רשם את זה).
	נחזור למקרה שלנו:
	נעדיף להשתמש בבסיס עבור בעיית דיריכלה:
	$$\begin{aligned}
X_{n}(x)=A_{n}\sinh(n\pi x)+B_{n}\sinh(n\pi(\pi-x)) &  & n=1,2,\dots 
\end{aligned}$$
נציב בפתרון הכללי:
$$w(x,y)=\sum_{n=1}^{\infty}[A_{n}\sinh(n\pi x)+B_{n}\sinh(n\pi(\pi-x))]\sin(n\pi y) $$
נציב את התנאי שפה (עבור $X$):
$$w(0,y)=\sum_{n=1}^{\infty}B_{n}\sinh(n\pi ^{2})\sin(n\pi y)=\sin(3\pi y) $$
נוכל לפרק ל-$n$-ים שונים:
$$\begin{aligned}
 &  n=3: &  & {B}_{3}\sinh(3\pi ^{2})=1 &  & \implies {B}_{3}=\dfrac{1}{\sinh(3\pi ^{2})} \\
 & \forall n\neq 3: &  & B_{n}\sin(n\pi ^{2})=0 &  & \implies B_{n}=0
\end{aligned}$$
התנאי שפה השני:
$$w(\pi,y)=\sum_{n=1}^{\infty}A_{n}\sinh(n\pi ^{2})\cdot \sin(n\pi y)=0 $$
נקבל כי:
$$A_{n}=0$$
לכן, הפתרון הפרטי של $w$ יהיה:
$$\boxed {
w=(x,y)=\dfrac{\sinh(3\pi(\pi-x))}{\sinh(3\pi ^{2})}\sin(3\pi y)
 }$$
כאשר נפתור עבור $v$ באותו אופן (אבל הפעם הבעיית שטורם ליוביל נרשום עבור $X$), נקבל:
$$\boxed {
v(x,y)=\sum_{k=1}^{\infty} \dfrac{8}{\pi(2k-1)^{2}} \dfrac{\sinh((1-y)(2k-1))}{\sinh(2k-1)}\sin((2k-1)x)
 }$$
כעת נותר פשוט לרשום:
$$z=v+w$$
ועבור $u$:
$$u=z+p$$

# משפט המקסימום

### משפט המקסימום החלש
>[!theorem] משפט: 
 >יהיה $D$ תחום חסום, כך ש- $u\in C^{2}(D)\cap C(\bar{D})$ ו-$u$ הרמונית ב-$D$. אז המקסימום והמינימום של $u$ ב-$\bar{D}$ מתקבל על שפת התחום $\partial D$.

### משפט המקסימום החזק
>[!theorem] משפט: 
 >תהי $u$ הרמונית בתחום $D$. אם $u$ מקבלת מינימום ומקסימום בנקודה פנימית ב-$D$, אז $u$ קבועה ($D$ לאו דווקא חסום).

### שילוב המשפטים

 כאשר נשלב את שני המשפטים, נוכל להסיק כי:
>[!info] מסקנה: 
 >אם $u$ הרמונית לא קבועה, רציפה על השפה, המינימום והמקסימום מתקבלים על השפה *בלבד* (כאשר $D$ תחום חסום).
 
 
 --- 
 
 **תרגיל:** 
עבור התרגיל הקודם, בדקו האם ייתכן $u>4$? $u<0$?

**פתרון:**
נשים לב כי $u$ הרמונית, היא לא קבועה על השפה (כבר על השפה היא לא קבועה), והיא גם רציפה על השפה. לפי המשפטים, המינימום והמקסימום מתקבלים על השפה בלבד. נבדוק מינימום ומקסימום על השפה:
$$\begin{aligned}
 & {f}_{1}(x)=x(\pi-x)  & & \implies \max_{0<x<\pi}({f}_{1})=\dfrac{\pi ^{2}}{4} \\
 & {f}_{2}(x)=x &  & \implies \max_{0<x<\pi}({f}_{2})=\pi \\
 & {g}_{1}(y)=\sin(3\pi y) &  & \implies \max_{0<y<1}({g}_{1})=1 \\
 & {g}_{2}(y)=\pi y &  & \implies \max_{0<y<1}({g}_{2})=\pi
\end{aligned}$$
נסיק כי:
$$\max_{\bar{D}}(u)=\pi$$
ולכן לא ייתכן ש-$u<4$. באותו אופן עבור מינימום היינו מקבלים:
$$\min_{\bar{D}}=-1$$
ולכן ייתכן ש-$u<0$.

# זהות גרין
זהויות ערין הן כלפי חשוב לניתוח בעיות אליפטיות ובפרט למשוואת פואסון. באמצעותן ניתן לנסח תנאי הכרחי לקיום פתרון לבעית נוימן, ולהוכיח את יחידות הפתרון (בדומה לשיטת [[PDE1_006 שיטת הפרדת משתנים#אינטגרל האנרגיה ויחידות הפתרון|אינטגרל האנרגיה]]).

מ[[../CAL2/CAL2_014 אינטגרלים משטחיים#משפט גאוס#משפט גאוס|משפט גאוס]] ניתן למצוא את **זהות גרין**:
>[!info] טענה: 
 >יהי $D$ תחום חסום בעל שפה חלקה למקוטעין. לכל שתי פונקציות $u,v$ כך ש- $u,v\in C^{2}(D)\cap C^{1}(\bar{D})$ מתקיים:
 >$$\int _{D}\vec{\nabla}u\cdot \vec{\nabla}v+v\Delta u \, \mathrm{d}A=\int _{\partial D}v\dfrac{ \partial u }{ \partial n }  \, \mathrm{d}s $$

כאשר נציב $v\equiv 1$ בזהות, נסיק כי תחת אותם תנאים מתקיים:
$$\int _{D}\Delta u \, \mathrm{d}A=\int _{\partial D} \dfrac{ \partial u }{ \partial n } \, \mathrm{d}s $$

לנוסחה זו יהיה שימוש כאשר נרצה למצוא תנאי לקיום פתרון עבור בעיית נוימן.

### #אלגוריתם: הוכחה ליחידות הפתרון בעזרת זהות גרין

אם נרצה לדעת האם הפתרון שקיבלנו עבור בעיית לפלס/פואסון היא יחידה, בדומה מאוד ל[[PDE1_006 שיטת הפרדת משתנים#אינטגרל האנרגיה ויחידות הפתרון|שיטת אינטגרל האנרגיה]], נניח כי ${u}_{1},{u}_{2}$ הן פתרונות לבעיה. נגדיר $w={u}_{2}-{u}_{1}$, ונכתוב מחדש את הבעיה עבור $w$. נשים לב ש-$w$ פותר את הבעיה ההומוגנית עם תנאי שפה הומוגניים.

נציב את $w$ בזהות גרין כדי לחשב אותו, ולמצוא האם הוא $0$, קבוע, או סתם יצור אחר מגעיל כזה. אם הוא אכן $0$, נסיק ש- ${u}_{2}-{u}_{1}=0$ ולכן ${u}_{1}={u}_{2}$ בתחום הבעיה. כלומר, הוכחנו את יחידות הפתרון.

# בעיית נוימן במלבן
 
בעיית נוימן במלבן היא בעיה מהצורה:
$$\begin{aligned}
 & \Delta u=0 &  & 0<x<a,\, 0<y<b \\
 & u_{y}(x,0)={f}_{1}(x)  &  & 0\leq x\leq a\\
 & u_{y}(x,b)={f}_{2}(x)  &  & 0\leq x\leq a\\
 & u_{x}(0,y)={g}_{1}(y)  &  & 0\leq y\leq b\\
 & u_{x}(a,y)={g}_{2}(y) &  & 0\leq y\leq b
\end{aligned}$$

נזכור שחשוב לבדוק עבורה תנאי תואמות אם אנו מעוניינים בפתרון אמיתי. כדי לבדוק זאת, נגזור למשל את תנאי ההתחלה עבור $u_{y}(x,0)$ לפי $x$, נציב $x=0$, נגזור את תנאי ההתחלה עבור $u_{x}(0,y)$ לפי $y$, נציב $y=0$, ונשווה בין שני הנגזרות. אנו יכולים לעשות זאת בגלל [[../CAL2/CAL2_006 נגזרות של פונקציות בשני משתנים#שוויון נגזרות מעורבות|שוויון נגזרות מעורבות]].

נשים לב שבפתרון בעיות נוימן, עלינו לבדוק את התנאי הבא:

>[!info] למה: 
 >תנאי הכרחי לקיום פתרון בעיית נוימן הוא:
$$\oint_{\partial D}\dfrac{ \partial u }{ \partial n } (x,y)\mathrm{d}s=\int _{D}F(x,y) \, \mathrm{d}A $$

ההיגיון הפיזיקלי העומד מאחורי למה זו: כיוון ש-$u$ מתאר טמפרטורה במצב שיווי משקל, שטף החום ([[../THE1/THE1_001 הקדמה ומושגי יסוד#חום|אינטראקציית חום]]) דרך השפה $\partial D$ מאוזן עם קצב ייצור החום בתחום.


לפי [[../CAL2/CAL2_012 אינטגרלים קוויים ומשפט גרין#משפט גרין לתחום פשוט קשר|משפט גרין]], במקרה הפשוט ההומוגני שלנו:
$$\boxed {
\int_{0}^{a} {f}_{2}(x)-{f}_{1}(x) \, \mathrm{d}x+\int_{0}^{b} {g}_{2}(y)-{g}_{1}(y) \, \mathrm{d}y=0 
 } $$


 --- 
 
 **תרגיל:** 
 נתונה הבעיה הבאה:
 $$\begin{aligned}
 &  \Delta u=0 &  & 0<x<1,\, 0<y<\pi \\
 & u_{y}(x,0)=0 &  & 0\leq x\leq 1 \\
 & u_{y}(x,\pi)=-\pi x+a &  & 0\leq x\leq 1 \\
 & u_{x}(0,y)=0 &  & 0\leq y\leq \pi \\
 & u_{x}(1,y)=\dfrac{y}{\pi}-\dfrac{1}{2} &  & 0\leq y\leq \pi\end{aligned}$$ 
 מצא $a$ כך שלבעיה קיים פתרון.
 
**פתרון:**
נציב בתנאי לקיום הפתרון:
$$\begin{gathered}
\int_{0}^{1} (-\pi x+a-0) \, \mathrm{d}x +\int_{0}^{\pi} \left( \dfrac{y}{\pi}-\dfrac{1}{2}-0 \right) \, \mathrm{d}y=0 \\[1ex]
\left( \pi\cdot \dfrac{x^{2}}{2}+ax \right)\bigg|_{0}^{1} +\left( \dfrac{y^{2}}{2\pi}-\dfrac{1}{2}y \right)\bigg|_{0}^{\pi} =0 \\[1ex]
\left( -\dfrac{\pi}{2}+a \right)+\left( \dfrac{\pi}{2}-\dfrac{\pi}{2} \right)=0 \\[1ex]
\boxed {
a=\dfrac{\pi}{2}
 }
\end{gathered} $$

>[!notes] הערה: 
 >
כאשר נפתור את הבעיה, נצטרך לפצל אותה לשתי בעיות עבור $v$ ו-$w$. גם עבור בעיות אלו נצטרך לבדוק תנאי לקיום פתרון כי הן בעיות חדשות.