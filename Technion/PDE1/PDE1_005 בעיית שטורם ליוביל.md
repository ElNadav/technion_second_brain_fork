---
aliases:
  - שטורם-ליוביל
  - מרחב מכפלה פנימית
---
# מבוא
ב[[PDE1_004 משוואת הגלים#משוואת הגלים בתחום סופי|משוואת הגלים בתחום סופי]] ראינו דוגמה לבעית התחלה-שפה הניתנת לפתרון בעזרת שיטת הפרדת משתנים. נרצה כעת לבסס את השיטה מבחינה תאורטית.
נתבונן בבעיה היפרבולית המתארת תנודת מיתר לא הומוגני. המד"ח היא הכללה של משוואת הגלים:
$$\begin{aligned}
 & u_{tt}-\dfrac{c^{2}}{r(x)}[(p(x)u_{x})_{x}+q(x)u]=0 &  & a<x<b,\, t>0 \\
 & u(x,0)=f(x)  &  & a\leq x\leq b\\
 & u_{t}(x,0)=g(x)  &  & a\leq x\leq b\\
 & \alpha u(a,t)+\beta u_{x}(a,t)=0 &  & t\geq 0 \\
 & \gamma u(b,t)+\delta u_{x}(b,t)=0 &  & t\geq 0
\end{aligned}$$
כאשר אנו מניחים שמקדמי המד"ח הם פונקציות ממשיות המקיימות:
$$\begin{aligned}
 & p,p',q,r\in C([a,b]) \\
 & p(x),r(x)>0,\, \forall x \in [a,b]  \\
 & c>0
\end{aligned}$$
ובנוסף ש:
$$\alpha,\beta,\gamma,\delta \in \mathbb{R},\, \quad |\alpha|+|\beta|>0,\, \quad |\gamma|+|\delta|>0$$

כאמור, תנאי שפה אלו כוללית למשל את [[PDE1_001 הקדמה ומשוואות מסדר ראשון#תנאי שפה|תנאי דיריכלה]]:
$$\alpha=\gamma=1,\, \quad \beta=\delta=0$$
וגם את תנאי נוימן:
$$\alpha=\gamma=0,\, \quad \beta=\delta=1$$
כזכור, אנו מחפשים פתרונות מופרדים *לא טריוויאליים* של המשוואה החלקית המקיימים את תנאי השפה ובעלי הצורה:
$$u(x,t)=X(x)T(t)$$
כאשר $X$ ו-$T$ הן פונקציות של משתנה אחד, $x$ ו-$t$ בהתאמה. נציב את הפתרון הזה במשוואה, נפריד משתנים, ונקבל:
$$\dfrac{T''}{c^{2}T}=\dfrac{(pX')'+qX}{rX}$$
אגף שמאל הוא פונקציה של $t$ בלבד ואילו אגף ימין תלוי אך ורק ב-$x$. לכן, קיים קבוע הפרדה $\lambda$ כך ש:
$$\dfrac{T''}{c^{2}T}=\dfrac{(pX')'+qX}{rX}=-\lambda$$
כלומר, יש לנו כאן סדרה משוואות דיפרנציאליות רגילות:
$$\begin{aligned}
 & (pX')'+qX+\lambda rX=0 &  & a<x<b \\
 & T''+\lambda c^{2}T=0 &  & t>0
\end{aligned}$$
מכיוון ש-$u$ אינו הפתרון הטריוויאלי, כדי שהפתרון $u$ יקיים את תנאי השפה צריך להתקיים:
$$\begin{gather}
\alpha X(a)+\beta X'(a)=0 \\
\gamma X(a)+\delta X'(b)=0
\end{gather}$$
כלומר, על הפונקציה $X$ לפתור את הבעיית שפה (שהיא מד"ר):
$$\begin{aligned} 
 & (pX')'+qX+\lambda rX=0  & a<x<b \\
&\alpha X(a)+\beta X'(a)=0 &  \\
&\gamma X(a)+\delta X'(b)=0 & 
\end{aligned}$$
וזוהי דוגמה **לבעיית שטורם-ליוביל רגולרית**. לפני שניגש לבעיה זו, מספר סימונים:
- הפונקציה $r(x)$ נקראת **פונקצית המשקל** של הבעיה.
- האופרטור הדיפרנציאלי $L[v]:=(pv')'+qv$ ייקרא **אופרטור מטיפוס שטורם-ליוביל**.
- ערך של $\lambda$ עבורו קיימים פרונות לא טריוואלים לבעיה ייקרא **ערך עצמי** והפתרון ייקרא **פונקציה עצמית** של אותו ע"ע.
- **הריבוי** של ע"ע הוא מימד המרחב הפונקציות העצמיות המתאימות לו. הריבוי של כל ערך עצמי יכל להיות $1$ או $2$. ע"ע עם ריבוי אחד ייקרא ע"ע פשוט.
- פתרון הבעיה משמעו מציאת כל הע"ע והפ"ע של הבעיה.

## בעיית שטורם-ליוביל רגולרית

>[!def] הגדרה: 
 >**בעיית שטורם-ליוביל רגולרית** היא בעיה מהצורה:
 >$$\begin{aligned}
 & (pv')'+qv+\lambda rv=0 & a<x<b \\
 & \alpha v(a)+\beta v'(a)=0 \\
 & \gamma v(b)+\delta v'(b)=0
\end{aligned}$$
כאשר:
>$$\begin{aligned}
 & p,p',q,r\in C([a,b]) \\
 & p(x),r(x)>0,\, \forall x \in [a,b]  \\
 & c>0
\end{aligned}$$
ובנוסף ש:
$$\alpha,\beta,\gamma,\delta \in \mathbb{R},\, \quad |\alpha|+|\beta|>0,\, \quad |\gamma|+|\delta|>0$$


>[!example] דוגמה: 
>עבור:
>$$p=r=1,\, q=0,\, \quad \quad (a,b)=(0,L)$$
>וכאשר $\alpha=\gamma=1,\,\beta=\delta=0$, אנו מקבלים את אותם התנאים על הבעיית שטורם ליוביל בתנאי דיריכלה מ[[PDE1_004 משוואת הגלים#משוואת הגלים בתחום סופי|משוואת הגלים בתחום סופי]]:
>$$\begin{aligned}
 & v''+\lambda v=0 &  & 0<x<L \\
 & v(0)=v(L)=0
\end{aligned}$$
הע"ע והפ"ע שנקבל הם:
$$\lambda_{n}=\left( \dfrac{n\pi}{L} \right)^{2},\, \quad v_{n}(x)=\sin\left( \dfrac{n\pi}{L}x \right),\, \quad n\in \mathbb{N}$$
>אם $\alpha=\gamma=0,\,\beta=\delta=1$, אז יש לנו תנאי נוימן והבעיה הופכת להיות:
>$$\begin{aligned}
 & v''+\lambda v=0 &  & 0<x<L \\
 & v'(0)=v'(L)=0
\end{aligned}$$
הע"ע והפ"ע שנקבל הם:
$$\lambda_{n}=\left( \dfrac{n\pi}{L} \right)^{2},\, \quad v_{n}(x)=\cos\left( \dfrac{n\pi}{L}x \right),\, \quad n\in \mathbb{N} \cup \{ 0 \}$$


>[!notes] הערה: 
 >כל הערכים העצמיים של בעיית שטורם-ליוביל רגולרית הם פשוטים (מריבוי $1$).

 
## בעיית שטורם-ליוביל מחזורית
>[!def] הגדרה: 
 >**בעיית שטורם-ליוביל מחזורית** היא בעיה מהצורה:
 >$$\begin{aligned}
 & (pv')'+qv+\lambda rv=0 & a<x<b  \\
 & v(a)=v(b) \\
 & v'(a)=v'(b) \\
\end{aligned}$$
כאשר:
>$$\begin{aligned}
 & p,p',q,r\in C([a,b]) \\
 & p(x),r(x)>0,\, \forall x \in [a,b]  \\
 & c>0
\end{aligned}$$
ומקדמי המשוואה $p,q,r$ הם פונקציות מחזוריות עם מחזור $(b-a)$.
בנוסף ש:
$$\alpha,\beta,\gamma,\delta \in \mathbb{R},\, \quad |\alpha|+|\beta|>0,\, \quad |\gamma|+|\delta|>0$$
 
>[!example] דוגמה: 
>עבור $L>0$:
>$$\begin{aligned}
 & v''+\lambda v=0  & -L<x<L \\
 & v(-L)=v(L) \\
 & v'(-L)=v'(L)
\end{aligned}$$
הע"ע והפ"ע של הבעיה הם:
>$$\lambda_{n}=\left( \dfrac{\pi n}{L} \right)^{2},\, \quad v_{n}(x)=A_{n}\cos\left( \dfrac{\pi n}{L}x \right)+B_{n}\sin\left( \dfrac{n\pi}{L}x \right)$$
>במקרה זה, הריבוי של $\lambda=0$ הוא $1$ בעוד שהריבוי של שאר הע"ע הוא $2$.

 
# תכונות הפונקציות העצמיות והערכים העצמיים

לפני שנעבור לתכונות מיוחדות של הפונקציות העצמיות והערכים העצמיים של בעיית שטורם-ליוביל, חשוב שנעבור על פעולת המכפלה הפנימית.

## מרחב מכפלה פנימית
ניזכר ב[[../CAL2/CAL2_001 וקטורים#מכפלה סקלרית פנימית|מכפלה סקלרית]] מחדו"א 2. נרחיב את מושג זה לפונקציות:

>[!def] הגדרה: 
 >[[../ALG1/ALG1_005 מרחבים וקטוריים#מרחב וקטורי|מרחב וקטורי]] $V$ ייקרא **מרחב מכפלה פנימית (ממשי)** אם לכל שני וקטורים קיים מספר $\langle u,v \rangle\in \mathbb{R}$ הנקרא **המכפלה הפנימית** של $u$ ו-$v$, באופן שהתכונות הבאות מתקיימות:
 >1. לכל $u,v\in V$ מתקיים $\langle u,v \rangle=\langle v,u \rangle$.
 >2. לכל $u,v,w\in V$ מתקיים $\langle u+v,w \rangle=\langle u,w \rangle+\langle v,w \rangle$.
 >3. לכל $u,v\in V$ ו-$\alpha \in \mathbb{R}$ מתקיים $\langle \alpha u,v \rangle=\alpha \langle u,v \rangle$.
 >4. לכל $u\in V$ מתקיים $\langle u,v \rangle\geq 0$, יתר על כן, $\langle u,v \rangle>0$ לכל $v\neq 0$.
 
 בהקשר של בעייית שטורם-ליוביל מופיע מרחב מכפלה פנימית טבעי.
עבור פונקציות:
>[!def] הגדרה: 
 >תהי $r(x)$ פונקצית משקל (חיובית) ורציפה בקטע $[a,b]$. עבור $u,v\in E(a,b)$ נגדיר **מכפלה פנימית**:
 >$$\langle u,v \rangle_{r}=\int _{a}^{b}u(x)v(x)r(x) \, \mathrm{d}x $$

>[!notes] הערה: 
 אנו נעסוק רק במכפלה הפנימית הזו, ולא במכפלה פנימית בין וקטורים אוקלידיים.

מרחב המכפלה הפנימית המתקבל יסומן $E_r(a,b)$, ועבור $r=1$ נסמן:
$${E}_{1} (a,b)=E(a,b)$$
באותו אופן:
$$\langle u,v \rangle_{1}=\langle u,v \rangle$$


נוכל כעת להמשיך לתכונות הע"ע והפ"ע של בעיית שטורם-ליוביל.
## סימטריות

>[!info] טענה:
>אופרטור שטורם-ליוביל על פונקציות המקיימות תנאי שפה של בעיית שטורם-ליוביל מקיים:
>$$\int_{a}^{b} uL[v]-vL[u] \, \mathrm{d}x =0$$

**הוכחה:**
נתבונן באופרטור שטורם ליוביל:
$$L[u]=(p(x)u')'+q(x)u$$
ונתבונן בביטוי $uL[v]-vL[u]$ עבור $u,v\in C^{2}([a,b])$. לפי [[../CAL1/CAL1_005 נגזרות#כללי גזירה|נגזרת של מכפלה]]:
$$\begin{aligned}
uL[v]-vL[u]&=u(pv')'+uqv-v(p u')'-vqu) \\
&=(upv)'-u'pv'-(vpu')'+u'pv'
\end{aligned}$$
קיבלנו את **זהות לגרנג'**:
$$uL[v]-vL[u]=[p(uv'-vu')]'$$
נבצע אינטגרציה על הזהות ונקבל את **נוסחת גרין**:
$$\int_{a}^{b} uL[v]-vL[u] \, \mathrm{d}x =p(uv'-vu')\bigg|_{a}^{b} $$

נניח עתה כי $u$ ו-$v$ מקיימות תנאי השפה של בעיית שטורם ליוביל. קל לראות כי:
	$$\int_{a}^{b}uL[v]-vL[u]  \, \mathrm{d}x=0 $$

$$\mathrm{ל.ש.מ} \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad$$

---
הפירוש האלגברי של נוסחה זו הוא שהאופרטור $L$ המוגדר על פונקציות שמקיימות את תנאי השפה של בעיית שטורם ליוביל, הוא סימטרי ביחס למכפלה הפנימית:
$$\langle u,v \rangle=\int_{a}^{b} u(x)v(x)  \, \mathrm{d}x $$

ולכן:
$$\langle L(u),v \rangle=\langle u,L(v) \rangle$$

## אורתוגנליות

>[!info] טענה: 
>עבור בעיית שטורם-ליוביל רגולרית או מחזורית, אם $u,v$ פ"ע של אותה הבעיה השייכות לע"ע שונים אז הן אורתוגונליות:
 >$$\langle u,v \rangle =0$$
 
 **הוכחה:**
 יהיו $v_{n},v_{m}$ פונקציות עצמיות השייכות לערכים העצמיים $\lambda_{n}\neq\lambda_{m}$ בהתאמה. כלומר:
 $$\begin{aligned}
 & -L[v_{n}]=\lambda_{n}rv_{n} \\
 & -L[v_{m}]=\lambda_{m}rv_{m}
\end{aligned}$$

ובנוסף $v_{n},v_{m}$ מקיימות את תנא השפה של בעיית שטורם-ליוביל.
נכפול את שתי הפונקציות ב-$v_{m}$ ו-$v_{n}$ בהתאמה. נבצע אינטגרציה ואז נפחית את המשוואות. נקבל את הסלט הבא:
$$-\int_{a}^{b} v_{m}L[v_{n}]-v_{n}L[v_{m}] \, \mathrm{d}x=(\lambda_{n}-\lambda _{m})\int_{a}^{b}v_{n}v_{m}r  \, \mathrm{d}x  $$
הואיל ו-$v_{n},v_{m}$ מקיימות את תנאי השפה של הבעיה, נוכל להשתמש ב[[#סימטריות]] ולקבל:
$$(\lambda_{n}-\lambda_{m})\int_{a}^{b} v_{n}v_{m}r \, \mathrm{d}x =0$$
אבל $\lambda_{n}\neq\lambda_{m}$, ולכן $\langle v_{n},v_{_{m}} \rangle_{r}=0$.
$$\mathrm{ל.ש.מ} \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad$$

---
 
 ב[[../ALG1/ALG1_010 וקטורים עצמיים וערכים עצמיים#ו"ע של ע"ע שונים הם בת"ל|אלגברה לינארית]] היה לנו קל יותר להבין את המשמעות של וקטורים אורתוגונליים - הם פשוט וקטורים שניצבים זה לזה. כאן, אין משמעות גיאומטרית אורתוגונליות של פונקציות. למרות זאת, היא מראה לנו מתי הן בת"ל.


## הע"ע והפ"ע ממשיים 
ישנן עוד טענות שאנו יכולים להסיק עבור ע"ע ופ"ע של בעיית שטורם-ליוביל, שאותן אין לי כוח להוכיח:
>[!info] טענה: 
 >עבור בעיית שטורם-ליוביל רגולרית או מחזורית:
 >1. כל הע"ע והפ"ע הם ממשיים.
 >2. כל הע"ע של בעיית שטורם-ליוביל רגולרית הם פשוטים.
 >3. אוסף הע"ע של הבעיה מהווה סדרה מונוטונית עולה המתכנסת לאינסוף.

## שלמות מערכת הפונקציות
בהמשך אנו נרצה לפתח את $f(x)$ (מהתנאי התחלה שלנו) לסדרת פונקציות $\{ f_{n} \}^{\infty_{}}_{n=0}$ כך שנוכל לבנות את הפתרון שלנו. כדי לעשות זאת, עלינו לספק מספר טענות.

>[!info] טענה: 
 >תהי $\{ v_{n} \}^{\infty}_{n=0}$ סדרה אורתוגונלית של כל הפונקציות העצמיות לבעיית שטורם-ליוביל בקטע $[a,b]$.
 >1. תהי $f$ גזירה למקוטעין בקטע $[a,b]$. אז לכל $x \in[a,b]$ הפיתוח של $f$ לפי הפונקציות העצמיות $\{ v_{n} \}^{\infty}_{n=0}$ מתכנס לממוצע הקפיצה של $f$, כלומר לערך $[f(x_{+})+f(x_{-})]/2$.
 >2. אם פונקציה רציפה וגזירה למקוטעין ומקיימת את שני תנאי השפה של בעיית שטורם-ליוביל הנתונה, אז הפיתוח של $f$ לפי הפונקציות העצמיות $\{ v_{n} \}^{\infty}_{n=0}$ מתכנס במידה שווה בקטע $[a,b]$.
 
 >[!Question]- מה זה התכנסות במידה שווה? 
 >נשים לב ש-$f$ הוא לא סתם פונקציה, הוא פונקציה שמורכבת מסכום של *אינסוף* פונקציות. התכנסות במידה שווה היא תכונה שאומרת שסדרת פונקציות ממשיות $\{ f_{n} \}^{\infty}_{n=0}$ מתכנסת לערך של סופי, שהוא הערך של $f$. זוהי לא הגדרה מדויקת, אבל הרעיון מאחוריה הוא שהתכונה הזאת מבטיחה שתכונות אחרות כמו רציפות ואינטגרביליות עובורת מפונקציות הסדרה $f_{n}$ לפונקציה הגבול $f$.

# פיתוח לפי פונקציות עצמיות

נתבונן בבעיית שטורם-ליוביל שמתקבלת מהפרדת המשתנים:
$$\begin{aligned}
 & L[v]+\lambda rv=0  & a<x<b \\
 & \alpha v(a)+\beta v'(a)=0 \\
 & \gamma v(b)+\delta v'(b)=0
\end{aligned}$$

תהי $\{ v_{n} \}^{\infty}_{n=0}$ הסדרה האורתוגונלית של הפונקציות העצמיות המתאימה לסדרת הערכת העצמיים $\{ \lambda_{n} \}^{\infty}_{n=0}$. נרצה לבנות את פתרון הבעיה מפונקציות עצמיות אלו. כדי לעשות זאת, נראה קודם איך אנחנו מציגים את הפונקציה $f$ כטור של הפונקציות העצמיות (כאשר $f$ היא תנאי התחלה של הבעיה). לשם הדיון, נניח שיש כזו הצגה עבור סדרת קובעים כלשהי $f_{n}$:
$$f(x)=\sum_{n=0}^{\infty}A_{n}v_{n}(x) $$

נכפיל את שני האגפים באחת הפונקציות העצמיות $v_{m}$. נעשה אינטגרציה ונקבל:
$$\int_{a}^{b} f(x)v_{m} \, \mathrm{d}x=\int_{a}^{b} \sum_{n=1}^{\infty } A_{n}v_{n}v_{m} \, \mathrm{d}x  $$
מאחר ואנו מניחים ש-$f$  היא פונקציה רציפה וגזירה למקוטעין המקיימת את תנאי השפה של הבעיה, אז הפיתוח לפי הסדרה $\{ v_{n} \}^{\infty}_{n=0}$ של $f$ מתכנסת במידה שווה. לכן, נוכל להפוך את סדר הסכימה והאינטגרציה:
$$\int_{a}^{b} f(x)v_{m} \, \mathrm{d}x =\sum_{n=1}^{\infty }A_{n}\int_{a}^{b} v_{n}v_{m} \, \mathrm{d}x  $$
מאורתוגונליות נקבל שכל האיברים בטור מתאפסים אלא אם כן $n=m$, ולכן:
$$\begin{gather}
\int_{a}^{b} f(x)v_{m} \, \mathrm{d}x =A_{m}\int_{a}^{b} v_{m}^{2} \, \mathrm{d}x   \\[1ex]
\langle f,v_{m} \rangle = A_{m}\langle v_{m},v_{m} \rangle \\[1ex]
A_{m}=\dfrac{\langle f,v_{m} \rangle}{\langle v_{m},v_{m} \rangle}
\end{gather}$$
קיבלנו כי המקדמים של הפ"ע נתונים ע"י:
$$A_{n}=\dfrac{\langle f,v_{n} \rangle}{\langle v_{n},v_{n} \rangle}$$
אמנם מה שהביא אותנו לנוסחה היה דיון לא פורמלי, אבל מסתבר שהטורים עם מקדמים אלו מקרבים את הפונקציה בצורה די טובה, למרות שלא תמיד מתקיים שוויון בין הפונקציה לטור שלה.

>[!notes] הערה: 
 >נשים לב שבבעיה של המד"ח קיבלנו תנאי התחלה ותנאי שפה שעלולים לחפוף בנקודה $(0,0)$:
 >$$u(x,0)=f(x),\, \quad u(0,t)=0$$
 >אבל יכל להיות שנתון ש-$f(0)\neq 0$ (יענו יש סתירה בין תנאי ההתחלה לתנאי השפה). כלומר, מה שנקבל זה שהטור שפיתחנו $\sum_{n=0}^{\infty}A_{n}v_{n}$ שווה ל-$f$ לכל $x$ שאינו בנקודת שפה.
 >מ[[#שלמות מערכת הפונקציות]] נסיק כי הפתרון $u$ שנבנה תקיים את המד"ח ואת תנאי השפה ואת תנאי ההתחלה חוץ מקצוותיה, כי שם תנאי השפה "מנצחים".
 >הבדלה זו רלוונטית רק אם ישנה סתירה בין תנאי ההתחלה לתנאי השפה.
