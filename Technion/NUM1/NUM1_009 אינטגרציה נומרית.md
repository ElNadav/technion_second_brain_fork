---
aliases:
  - אינטגרציה נומרית
  - נוסחאות ניוטון-קוטס
  - שיטה פתוחה
  - שיטה סגורה
---
# מבוא
נעסוק בפרק זה בפתרון [[../CAL1/CAL1_008 אינטגרל מסוים#האינטגרל המסוים|אינטגרל מסוים]] מהצורה:
$$I_{f}=\int_{a}^{b} f(x) \, \mathrm{d}x $$
עבור קטע סופי $[a,b]$ ופונקציה [[../CAL1/CAL1_008 אינטגרל מסוים#אינטגרביליות והאינטגרל המסוים|אינטגרבילית]] $f$.

# אינטגרציה נומרית בסיסית
בהינתן פונקציה $f$ בקטע הסגור $[a,b]$, אנו יכולים לבחור מספר מספר נקודות ${x}_{0},{x}_{1},\dots,x_{n}\in[a,b]$ ולבנות [[NUM1_007 אינטרפולציה פולינומית#אינטרפולנט והצגתו|אינטרפולנט]] $p_{n}(x)$. לפיכך:
$$\int_{a}^{b} p_{n}(x) \, \mathrm{d}x $$
יהיה קירוב טוב ל:
$$\int_{a}^{b} f(x) \, \mathrm{d}x $$

## פיתוח שיטות בסיסיות
אם נשתמש ב[[NUM1_007 אינטרפולציה פולינומית#אינטרפולציית לגרנג'|אינטרפולציית לגרנג']], נקבל כי:
$$\begin{aligned}
\int_{a}^{b} f(x) \, \mathrm{d}x \approx \int_{a}^{b} p_{n}(x) \, \mathrm{d}x &=\int_{a}^{b} \sum_{i=0}^{n} f(x_{i})L_{i}(x) \, \mathrm{d} x\\
&=\sum_{i=0}^{n}f(x_{i})\int_{a}^{b} L_{i}(x) \, \mathrm{d}x 
\end{aligned}  $$
נקרא לאינטגרל של הפולינום לגרנג' **מקדמי קוטס** ונסמנם:
$$H_{i}=\int_{a}^{b} L_{i}(x) \, \mathrm{d}x $$

לפיכך:
$$\int_{a}^{b} f(x) \, \mathrm{d}x \approx \sum_{i=0}^{n}H_{i}f(x_{i}) $$

למשל, עבור $n=1$ והנקודות בקצוות ${x}_{0}=a$ ו-${x}_{1}=b$. אז הפולינומני לגרנג':
$${L}_{0} (x)=\dfrac{x-b}{a-b},\, \quad {L}_{1} (x)=\dfrac{x-a}{b-a}$$
לכן, נקבל את המקדמים:
$$\begin{aligned}
 & {H}_{0} =\int_{a}^{b}  \dfrac{x-b}{a-b} \, \mathrm{d}x=\dfrac{b-a}{2} \\
 & {H}_{1} =\int_{a}^{b} \dfrac{x-a}{b-a} \, \mathrm{d}x =\dfrac{b-a}{2}
\end{aligned} $$
קיבלנו כאן את **שיטת הטרפזים**:
$$I_{f}=I_{\text{trap}}=\dfrac{b-a}{2}[f(a)+f(b)]$$
במקום אינטרפולנט לינארי בקצוות, נוכל גם לקחת אינטרפולנט ריבועי כאשר אנו לוקחים בחשבון גם את אמצע הקטע. כלומר, $n=2$ ו-:
$${x}_{0} =a,\, \quad {x}_{1} =\dfrac{b+a}{2},\, \quad {x}_{2} =b$$
אם נבנה את שלושת פולינימי לגרנג' ונבצע עליהם אינטגרציה אנו נקבל את **שיטת סימפסון**:
$$I_{f}=I_{\text{Simp}}=\dfrac{b-a}{6}\left[ f(a)+4f\left( \dfrac{b+a}{2} \right)+f(b) \right]$$

![[NUM1_009/Screenshot_20240302_151830_Samsung Notes.jpg|book]]
> שטח מתחת לגרף. הגרף בפינה השמאלית למעלה מייצג את השטח האמיתי מתחת לגרף. בפינה הימנית למעלה מוצג השטח לפי שיטת סימפסון, ופינה השמאלית למטה מוצג השטח לפי שיטת הטרפזים. הפינה הימנית למטה מייצגת מה קורה כשלא הבנם מה לעזאזל רוצים ממכם.

שיטת הטרפזים ושיטת סימפסון הם סוגים של נוסחאות **ניוטון-קוטס (Newton-Cotes formulas)**. אלו נוסחאות המתבססות על אינטרפולציה פולינומית בנקודות *במרחקים שווים*. נאמר כי אם הנקודות $a,b$ נכללות באינטרפולנט, אז זוהי **שיטה סגורה**. אחרת, זוהי **שיטה פתוחה**.

## שגיאה בשיטות בסיסיות
נרצה לדעת מה השגיאה בשיטות שלנו. השגיאה עבור אינטרפולציה נתונה ע"י חיסור הפונקציה והאינטרפולנט:
$$f(x)-p_{n}(x)$$

לכן, השגיאה באינטגרציה שלנו תהיה האינטגרל על חיסור זה:
$$E(f)=\int_{a}^{b} f(x) \, \mathrm{d}x -\sum_{i=0}^{n} H_{i}f(x_{i}) $$
למשל, עבור שיטת הטרפזים, נקבל כי:
$$E(f)=\int_{a}^{b} f(x) \, \mathrm{d}x-\dfrac{b-a}{2}[f(a)+f(b)] $$

ברור כי לא אנחנו לא באמת יודעים איך לחשב את האינטגרל של $f$, אבל אם אנו יודעים את נגזרות שלו, ניתן להראות כי עבור $\xi \in(a,b)$ מתקיים:
$$E(f)=-\dfrac{f''(\xi)}{12}(b-a)^{3}$$
בהינתן ו-$a$ ו-$b$ קרובים מספיק אחד לשני. ההוכחה לשיעור שגיאה זה הוא סתם אורך ואין לי כוח להראות אותו. מספיק לדעת שהוא נובע מ[[../CAL1/CAL1_006 פולינום טיילור#משפט טיילור|טיילור]].

עבור שיטת סימפסון ניתן להראות באותה צורה כי:
$$E(f)=-\dfrac{f''(\xi)}{90}\left( \dfrac{b-a}{2} \right)^{5}$$

 --- 
 **תרגיל:** 
חשב את האינטגרל הבא לפי השיטות הבאות. הערך את השגיאה המתקבלת בכל שיטה (תן חסמים), והשווה מול השגיאה בפועל.

1. אנליטי.
2. שיטת הטרפז.

**פתרון:**
1. נחשב פשוט את האינטגרל:
	$$\begin{aligned}
I=\int_{0}^{\pi/2} \sin x \, \mathrm{d}x =-\cos x\bigg|_{0}^{\pi/2} =-\cos \dfrac{\pi}{2}+\cos 0=1
\end{aligned}$$
2. לפי שיטת הטרפז, המרחקים בין הנקודות:
	$$h=b-a=\dfrac{\pi}{2}-0=\dfrac{\pi}{2}$$
	ולכן:
	$$I=\dfrac{h}{2}({f}_{0} +{f}_{1} )=\dfrac{\pi}{4}\left( \sin 0+\sin \dfrac{\pi}{2} \right)=\dfrac{\pi}{4}=0.785398$$
	הערכת השגיאה:
$$E=-\dfrac{1}{12}h^{3}f''(\xi)=-\dfrac{1}{2}\left( \dfrac{\pi}{2} \right)^{3}(-\sin(\xi))$$
	ולכן החסמים:
	$$\begin{aligned}
E&<-\dfrac{1}{12}\left( \dfrac{\pi}{2} \right)^{3}\left( -\sin\left( \dfrac{\pi}{2} \right) \right)=0.32298 \\
E&>-\dfrac{1}{12}\left( \dfrac{\pi}{2} \right)^{3}(-\sin 0)=0
\end{aligned}$$
	השגיאה בפועל היא:
	$$E=1-0.785398=0.214601$$


# אינטגרציה נומרית מרוכבת

>[!TODO] להשלים 
 >