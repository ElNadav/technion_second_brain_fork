---
aliases: שיטת החצייה, שיטת ניוטון
---
# מבוא
פרק זה עוסק במציאת פתרונות למשוואה הסקלרית, הלא לינארית:
$$f(x)=0$$
כאשר $x$ נמצא בטווח $[a,b]$. נניח תמיד שהפונקציה $f$ [[../CAL1/CAL1_004 רציפות#רציפות|רציפה]] על הקטע ($f\in C[a,b]$), ונסמן את הפתרון של הפונקציה ב-$x^{*}$, כאשר נקרא לו **שורש**.

![[NUM1_005/Screenshot_20240216_171044_Obsidian 1.jpg|book|400]]

> גרף של שלושה פונקציות והשורשים שלהם.

# שיטת החצייה

השיטה הבאה, שהיא בעצם אנלוגית לחיפוש בינארי, היא פשוטה ודורשת מעט מידע על הפונקציה $f(x)$. אבל, היא איטית ומסובך להכליל אותה למקרים רב מימדיים.

נניל ועבור $f(x)$ נתון אנו יודעים על תחום $[a,b]$ בו $f$ משנה סימן. [[../CAL1/CAL1_004 רציפות#משפט ערך הביניים|משפט ערך הביניים]] מבטיח לנו שקיים שורש $x^{*}$ כך ש- $a\leq x^{*}\leq b$. כעת, נחשב את $f(p)$, כאשר
$$p=\dfrac{a+b}{2}$$
הוא החציון, ונבדוק את הסימן של המכפלה $f(a)\cdot f(p)$. אם היא שלילית, אז השורש נמצא בקטע $[a,p]$, אז אנחנו יכולים להציב $b=p$ ולחזור על הפעולה.
אם $f(a)\cdot f(p)$ חיובית, אז השורש נמצא על הקטע $f[p,b]$, אז נציב $a=p$ ונחזור על הפעולה.
אנחנו נעצור את האלגוריתם כאשר $f(a)\cdot f(p)=0$, ואז נסיק כי $x^{*}=p$.

בכל איטרציה על הקטע $[a,b]$ בו $x^{*}$ נמצא, הקטע קטן פי $2$, ולכן השיטה נקראת **שיטת החצייה**. באיטרציה ה-$n$-ית, מתקיים $|x^{*}-x_{n}|\leq \dfrac{b-a}{2}\cdot 2^{-n}$. לכן, האלגוריתם מחויב להתכנס.

# שיטת ניוטון ו-Secant

שיטת החציון רק דורשת שהפונקציה $f$ תהיה רציפה (שזה סבבה והכל) ולא צריכה יותר מדי אינפורמציה על נגזרות הפונקציה, או אפילו על הקיום שלהן.

**שיטת ניוטון** דורשת יותר מידע על [[../CAL2/CAL2_004 עקומים במרחב|חלקלקות]] הפונקציה, אבל היא מתכנסת הרבה יותר מהר לשורש.

## #אלגוריתם: שיטת ניוטון

שיטה זו היא הדרך המהירה הבסיסית ביותר למציאת שורש. הרעיון שעומד מאחוריו ניתן להכללה כדי לפתור בעיות יותר כלליות.

נניח שהנגזרת הראשונה והשנייה של $f$ קיימות ורציפות ($f\in C^{2}[a,b]$. נניח גם שניתן לחשב את $f'$ יחסית בקלות. לפי פיתוח [[../CAL1/CAL1_006 פולינום טיילור#משפט טיילור|טיילור]] עבור $f$, אנחנו יכולים לרשום:
$$f(x)=f(x_{k})+'(x_{k})(x-x_{k})+\dfrac{f''(\xi(x))(x-x_{k})^{2}}{2}$$
כאשר $\xi(x)$ היא נקודה (לא ידועה) בין נקודה $x$ לנקודה $x_{k}$.
אם $x=x^{*}$, אז $f(x^{*})=0$. אם $f$ היתה לינארית, אז $f''\equiv0$, ואז נוכל למצוא את השורש כאשר נפתור
$$f(x_{x})+f'(x_{k})+f'(x_{k})(x^{*}-x_{k})=0$$
ונקבל:
$$x^{*}=x_{k}-\dfrac{f(x_{k})}{f'(x_{k})}$$
לפונקציה לא לינארית נגדיר את האיטרציה הבאה ע"י אותה הנוסחה:
$$\boxed {
x_{k+1}=x_{k}- \dfrac{f(x_{k})}{f'(x_{k})},\, \quad k=0,1,2,\dots 
 }$$
אנחנו מתעלמים מהביטוי $\dfrac{f''(\xi(x^{*}))(x^{*}-x_{k})^{2}}{2}$ בכל איטרציה לא רק כי אנחנו לא יודעים לחשב אותו, אלא גם כי הוא זניח יותר ויותר ככל שאנחנו מתקרבים לשורש (הביטוי $(x^{*}-x_{k})^{2}$ קטן מאוד מהר).

מבחינה גאומטרית, $x_{k+1}$ הוא המפגש של המשיק ל-$f$ ב-$x_{k}$ עם ציר ה-$x$:

![[NUM1_004/NewtonIteration_Ani (1).gif|book|400]]

---

**תרגיל:**
פתרו בעזרת שיטת ניוטון את אחד מהשורשים של הפונקציה הבאה:
$$f(x)=x-\cos x$$
עם הניחוש ההתחלתי:
$${x}_{0} =\dfrac{\pi}{4}$$
**פתרון:**
הנגזרת:
$$f'(x)=1+\sin x$$
לפי הנוסחה:
$$x_{n+1}=x_{n}-\dfrac{x_{n}-\cos x_{n}}{1+\sin x_{n}}$$
נוכל להתחיל לחשב איטרציות:
$$\begin{aligned}
&{x}_{1} =\dfrac{\pi}{4}-\dfrac{\dfrac{\pi}{4}-\cos\left( \dfrac{\pi}{4} \right)}{1+\sin\left( \dfrac{\pi}{4} \right)}=0.7395 \\[2ex]
&x_{2}=0.7935- \dfrac{0.7395-\cos(0.7395)}{1+\sin(0.7395)}=0.7391
\end{aligned}$$

---

**תרגיל:**
על מנת לחשב $\dfrac{1}{a}$ עבור $a>0$, מוצע להשתמש בשיטת ניוטון ולחשב שורש של פונקציה:
$$f(x)=x^{-1}-a$$
1. רשום ביטוי מפורש באמצעותו יחושבו הקירובים $x_{k}$ עבור $k=1,2,\dots$.
	**פתרון:**
	הנגזרת:
	$$f'(x)=-\dfrac{1}{x^{2}}$$
	ולפי הנוסחה לאיטרציה:
$$x_{n+1}=x_{n}- \dfrac{x_{n}^{-1}-a}{-x_{n}^{-2}}=x_{n}+{x}_{n}-ax_{n}^{2}=x_{n}(2-ax_{n})$$
2. האם מובטחת התכנסות של שיטת ניוטון במקרה הנתון ללא תלות בניחוש ההתחלתי?
	**פתרון:**
	נראה מה קורה:
	- **כאשר** ${x}_{0}<0$:
			$${x}_{1} ={x}_{0} (2-a{x}_{0} )<0$$
			נקבל שתמיד:
			$$x_{n}<0$$
	- **כאשר** ${x}_{0}=0$:
		$${x}_{1} =0\implies x_{n}=0$$
	- **כאשר** $x_{0}=\dfrac{2}{a}$:
		$${x}_{1} =\dfrac{2}{a}\left( 2-a\cdot \dfrac{2}{a} \right)=0\implies x_{n}=0$$
	- **כאשר** $x_{0}> \dfrac{2}{a}$:
		$${x}_{1}={x}_{0} \left( 2-a\cdot \dfrac{2}{a} \right)<0$$
	- **כאשר** $0<{x}_{0}< \dfrac{2}{a}$:
		$$\begin{aligned}
{x}_{1}& ={x}_{0} (2-a{x}_{0} ) \\
&=2{x}_{0} -a{x}_{0} ^{2} \\
&=2{x}_{0} -a{x}_{0} ^{2}-\dfrac{1}{a}+\dfrac{1}{a} \\
&=-\dfrac{1}{a}(a^{2}{x}_{0} ^{2}-2a{x}_{0} +1)+\dfrac{1}{a} \\
&=\underbrace{ -\dfrac{1}{a}(a{x}_{0} ^{2}-1) }_{ \leq 0 }+\dfrac{1}{a}
\end{aligned}$$
		ולכן נסיק כי:
		$${x}_{1} \leq  \dfrac{1}{a}$$
		נוכל להמשיך ב[[../BMA1/BMA1_003 אינדוקציה#אינדוקציה|אינדוקציה]] ולקבל:
		$$0<x_{n}\leq \dfrac{1}{a},\, \quad n=1,2,3,\dots $$
		לכן, נוכל להוכיח שהסדרה בעצם עולה:
		$$\begin{aligned}
0<x_{n}< \dfrac{1}{a}&\implies x_{n+1}-x_{n}=ax_{n}\left( \dfrac{1}{a} -x_{n} \right)>0 \\
&\implies x_{n+1}>x_{n}
\end{aligned}$$
	הסדרה חסומה מלמעלה ומונוטונית [[../CAL1/CAL1_003 גבולות של סדרות#משפטי גבולות של סדרות|ולכן מתכנסת]]. נוכיח כי ההתכנסות היא אל $x^{*}=\dfrac{1}{a}$:
	$$x_{n+1}=x_{n}(2-ax_{n})\implies  \dfrac{x_{n+1}}{x_{n}}=(2-ax_{n})$$
	לכן הגבול:
	$$\lim_{ n \to \infty } \dfrac{x_{n+1}}{x_{n}}=\lim_{ n \to \infty } (2-ax_{n})=2-\lim_{ n \to \infty } ax_{n} $$
	נציב ש-$\lim_{ n \to \infty }ax_{n}=2-1=1$:
	$$\lim_{ n \to \infty } x_{n}=\dfrac{1}{a}$$

---
## קצב ההתכנסות
כמה מהר איטרציה לא לינארית מתכנסת, אם בכלל? נניח שהשיטה באמת מתכנסת וש- $x_{k}$ "קרוב מספיק" לשורש $x^{*}$. נגדיר **קצבי התכנסות** בצורה הבאה.
>[!def] הגדרה: 
 >נאמר כי אלגורתים:
 >- **מתכנסת לינארית** אם ישנו קבוע $\rho<1$ כך ש:
 >- $$|x_{k+1}-x^{*}|\leq \rho \left|x_{k}-x^{*}\right|$$
 >	לכל $k$ גדול מספיק.
 >- **מתכנסת ריבועית** אם ישנו קבוע $M$ כך ש:
 >	$$\left|x_{k+1}-x^{*}\right|\leq M\left|x_{k}-x^{*}\right|^{2}$$
 >- **מתכנסת סופרלינארית** אם ישנם סדרה של קבועים $\rho_{k}\to 0$ כך ש:
 >	$$\left|x_{k+1}-x^{*}\right|\leq \rho_{k}\left|x_{k}-x^{*}\right|$$
 >	לכל $k$ גדול מספיק.
 
 נשים לב שעבור התכנסות ריבועית אנחנו יכולים לבחור:
 $$\rho_{k}=M\left|x_{k}-x^{*}\right|\xrightarrow[k\to \infty]{}0$$
 לכן, התכנסות ריבועית גוררת התכנסות סופרלינארית. התכנסות סופרלינארית דורשת פחות מזה, אבל דורשת יותר מהתכנסות לינארית.

עבור שיטת ניוטון, אפשר להראות שאם $f\in C^{2}[a,b]$ וקיים שורש $x^{*}$ ב-$[a,b]$ כך ש- $f(x^{*})=0,\,f'(x^{*})\neq 0$, אז קיימת סביבה של $x^{*}$ שאם נתחיל עם $x_{0}$ בסביבה זו, אז שיטת ניוטון מתכנסת ריבועית.

## #אלגוריתם: שיטת Secant

הדרישה בשיטת ניוטון שלא רק הפונקציה $f$ אלא גם הנגזרת שלה $f'$ תהיה נתונה לפעמים מתקיימת. אבל, לא תמיד נוכל לחשב את הנגזרת, או שלפעמים יהיה יותר מסובך לחשב את הנגזרת $f'$ מאשר את $f$ עצמה.

**שיטת Secant** היא וריאציה של שיטת ניוטון, כאשר $f'(x_{k})$ מוחלף ע"י קירוב סופי שתלוי בפונקציה בנקודה $x_{k}$ ואיטרציה קודמת $x_{k-1}$. בהנחה וישנה התכנסות:
$$f'(x_{k})\approx \dfrac{f(x_{k})-f(x_{k-1})}{x_{k}-x_{k-1}}$$
כאשר מציבים את קירוב זה בתוך הנוסחה של שיטת ניוטון, אנחנו מקבלים את השיטת Secant:
$$\boxed{x_{k+1}=x_{k}-\dfrac{f(x_{k})(x_{k}-x_{k-1})}{f(x_{k})-f(x_{{k}_{1}-1})},\, \quad k=0,1,2,\dots  }$$

